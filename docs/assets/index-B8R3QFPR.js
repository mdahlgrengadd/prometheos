import{c as G,i as Xe,r as a,R as re,J as Ye,j as t,h as Y}from"./index-B3VsASHN.js";import{F as se,S as Ze,u as Z}from"./fileSystem-laUeelC0.js";import{ideSettings as le}from"./esbuild-settings-Bzyyd_qg.js";import{a9 as Je,aa as Qe,ab as et,b as tt,C as ie,ac as ve}from"./MacroContext-BqOkWMuI.js";import{F as nt}from"./file-text-C5wutG3W.js";import{T as rt,D as st,P as ot}from"./trash-2-DAbXSUTp.js";import{H as Ce}from"./house-DRvTRxXp.js";import{R as at}from"./refresh-cw-DIIHU1V_.js";import"./monaco-editor-Dq6WuQlL.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=G("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=G("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=G("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=G("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=G("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=G("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=G("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var ne={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function pt(n,r){return n+r.charAt(0).toUpperCase()+r.substring(1)}var ht=["Webkit","ms","Moz","O"];Object.keys(ne).forEach(function(n){ht.forEach(function(r){ne[pt(r,n)]=ne[n]})});var xt={isUnitlessNumber:ne},gt=xt,bt=/^ms-/,yt=/([A-Z])/g;function vt(n){return n.replace(yt,"-$1").toLowerCase()}function wt(n){return vt(n).replace(bt,"-ms-")}var jt=wt,St=gt.isUnitlessNumber,Ct=jt,Nt=Array.isArray,we=Object.keys,kt=/^(normal|none|(\b(url\([^)]*\)|chapter_counter|attr\([^)]*\)|(no-)?(open|close)-quote|inherit)((\b\s*)|$|\s+))+)$/;function je(n,r){return!St[n]&&typeof r=="number"?r=""+r+"px":n==="content"&&!kt.test(r)&&(r="'"+r.replace(/'/g,"\\'")+"'"),Ct(n)+": "+r+";  "}function Et(n){var r="";if(!n||we(n).length===0)return r;for(var c=we(n),l=0,h=c.length;l<h;l++){var d=c[l],f=n[d];if(Nt(f))for(var u=0,x=f.length;u<x;u++)r+=je(d,f[u]);else r+=je(d,f)}return r}var Dt=Et;const Se=Xe(Dt);function J(){return J=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var c=arguments[r];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(n[l]=c[l])}return n},J.apply(this,arguments)}const Pt=["style"],Rt=a.forwardRef((n,r)=>{let{style:c={}}=n,l=function(u,x){if(u==null)return{};var N,C,i={},p=Object.keys(u);for(C=0;C<p.length;C++)x.indexOf(N=p[C])>=0||(i[N]=u[N]);return i}(n,Pt);const h=a.useRef(null),d=a.useRef(null),[,f]=a.useState(0);return a.useImperativeHandle(r,()=>({getBoundingClientRect:()=>{var u;return(u=h.current)==null?void 0:u.getBoundingClientRect()},getParentBoundingClientRect:()=>{var u,x;return h==null||(u=h.current)==null||(x=u.parentElement)==null?void 0:x.getBoundingClientRect()},drawSelectionBox:u=>{requestAnimationFrame(()=>{if(d.current){const x=J({border:"1px solid #4C85D8",background:"rgba(155, 193, 239, 0.4)",position:"absolute",pointerEvents:"none"},c,{top:u.top,left:u.left,width:u.width,height:u.height});d.current.style.cssText=Se(x)}})},clearSelectionBox:()=>{requestAnimationFrame(()=>{d.current&&(d.current.style.cssText=Se({top:0,left:0,width:0,height:0}))})}})),a.useEffect(()=>{f(u=>u+1)},[]),re.createElement("div",{ref:h},h.current?Ye.createPortal(re.createElement("div",J({ref:d},l)),h.current):null)});function Mt(n){return(r=>r.width*r.height)(n)>10}function Ft(n){const{onSelectionChange:r,onSelectionEnd:c,onSelectionStart:l,isEnabled:h=!0,selectionProps:d={},eventsElement:f,shouldStartSelecting:u,isValidSelectionStart:x}=n||{},N=a.useRef(null),{cancelCurrentSelection:C}=function({containerRef:i,onSelectionChange:p,onSelectionStart:S,onSelectionEnd:F,isEnabled:o=!0,eventsElement:m,shouldStartSelecting:w,isValidSelectionStart:M=Mt}){const k=a.useRef(null),E=a.useRef(null),D=a.useRef(!1),z=a.useRef(p),B=a.useRef(S),ee=a.useRef(F),W=a.useRef(),te=a.useRef(o);z.current=a.useCallback(v=>{W.current=p?requestAnimationFrame(()=>{p(v)}):void 0},[p]),B.current=S,ee.current=F,te.current=o;const I=a.useCallback(()=>{var v;k.current=null,E.current=null,D.current=!1,(v=i.current)==null||v.clearSelectionBox(),typeof W.current=="number"&&cancelAnimationFrame(W.current)},[i]),q=a.useCallback((v,y)=>{var T,A,H;return y||(y=(H=i.current)==null?void 0:H.getParentBoundingClientRect()),{x:v.clientX-(typeof((T=y)==null?void 0:T.left)=="number"?y.left:0),y:v.clientY-(typeof((A=y)==null?void 0:A.top)=="number"?y.top:0)}},[i]),U=a.useCallback((v,y)=>{if(k.current&&E.current){if(!y)return;const A=(({startPoint:L,endPoint:V})=>({left:Math.min(L.x,V.x),top:Math.min(L.y,V.y),width:Math.abs(L.x-V.x),height:Math.abs(L.y-V.y)}))({startPoint:k.current,endPoint:E.current}),H=J({},A,{top:A.top+((y==null?void 0:y.top)||0),left:A.left+((y==null?void 0:y.left)||0)});var T;M(A)?(D.current||(B!=null&&B.current&&B.current(v),D.current=!0),(T=i.current)==null||T.drawSelectionBox(A),z.current==null||z.current(H)):D.current&&(z.current==null||z.current(H))}else I()},[I,i]),$=a.useCallback(v=>{var y;if(!k.current)return;const T=(y=i.current)==null?void 0:y.getParentBoundingClientRect();E.current=q(v,T),U(v,T)},[U,q,i]),P=a.useCallback(v=>{var y;v.button===0&&(E.current&&(ee.current==null||ee.current(v)),I(),document.body.style.removeProperty("user-select"),document.body.style.removeProperty("-webkit-user-select"),(m||document.body).removeEventListener("mousemove",$),(y=window)==null||y.removeEventListener("mouseup",P))},[m,I,$]),R=a.useCallback(v=>{if(v.button===0&&te.current){var y;if(typeof w=="function"&&!w(v.target))return;document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",k.current=q(v),(m||document.body).addEventListener("mousemove",$),(y=window)==null||y.addEventListener("mouseup",P)}},[m,q,$,P]);return a.useEffect(()=>((m||document.body).addEventListener("mousedown",R),()=>{(m||document.body).removeEventListener("mousedown",R),(m||document.body).removeEventListener("mousemove",$),window.removeEventListener("mouseup",P)}),[m,R,$,P]),{cancelCurrentSelection:I}}({containerRef:N,onSelectionEnd:c,onSelectionStart:l,onSelectionChange:r,isEnabled:h,eventsElement:f,shouldStartSelecting:u,isValidSelectionStart:x});return{cancelCurrentSelection:C,DragSelection:a.useCallback(()=>re.createElement(Rt,J({ref:N},d)),[])}}const Tt=["txt","js","jsx","ts","tsx","md","css","html","json","csv","xml","yml","yaml","py","c","h","cpp","cc","hpp"],Ne=n=>{var c;if(n.type==="folder")return t.jsx(se,{className:"w-4 h-4 text-blue-500"});switch((c=n.name.split(".").pop())==null?void 0:c.toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return t.jsx(et,{className:"w-4 h-4 text-green-500"});case"txt":case"doc":case"docx":case"pdf":case"rtf":return t.jsx(nt,{className:"w-4 h-4 text-red-500"});case"mp3":case"wav":case"flac":case"ogg":return t.jsx(Qe,{className:"w-4 h-4 text-purple-500"});case"mp4":case"avi":case"mkv":case"mov":case"wmv":return t.jsx(mt,{className:"w-4 h-4 text-orange-500"});case"zip":case"rar":case"7z":case"tar":case"gz":return t.jsx(lt,{className:"w-4 h-4 text-yellow-500"});case"js":case"ts":case"html":case"css":case"py":case"java":case"cpp":case"c":case"php":return t.jsx(Je,{className:"w-4 h-4 text-cyan-500"});case"exe":case"msi":case"dmg":return t.jsx(Ze,{className:"w-4 h-4 text-indigo-500"});default:return t.jsx(it,{className:"w-4 h-4 text-gray-500"})}},At=n=>{if(n===0)return"0 Bytes";const r=1024,c=["Bytes","KB","MB","GB","TB"],l=Math.floor(Math.log(n)/Math.log(r));return parseFloat((n/Math.pow(r,l)).toFixed(2))+" "+c[l]},ce=(n,r,c=["root"])=>{if(n.id===r)return c;if(n.children)for(const l of n.children){const h=ce(l,r,[...c,l.id]);if(h)return h}return null},It=({position:n,itemId:r,onRename:c,onDelete:l,setShowContextMenu:h})=>t.jsxs("div",{className:"fixed bg-white border border-gray-200 rounded-lg shadow-xl py-2 z-50 min-w-48",style:{left:n.x,top:n.y},children:[t.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-3 transition-colors",onClick:d=>{d.stopPropagation(),c(r),h(null)},children:[t.jsx(dt,{className:"w-4 h-4"}),"Rename"]}),t.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-3 text-red-600 hover:bg-red-50 transition-colors",onClick:d=>{d.stopPropagation(),l(r)},children:[t.jsx(rt,{className:"w-4 h-4"}),"Delete"]})]}),ke=({title:n,inputValue:r,onInputChange:c,onCancel:l,onKeyDown:h,children:d})=>t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:n}),t.jsx("input",{type:"text",value:r,onChange:c,onKeyDown:h,placeholder:"Enter name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),d]})]})}),$t=({newItemName:n,setNewItemName:r,setShowNewItemDialog:c,createNewItem:l,handleKeyDown:h})=>t.jsxs(ke,{title:"Create New Item",inputValue:n,onInputChange:d=>r(d.target.value),onCancel:()=>{c(!1),r("")},onKeyDown:h,children:[t.jsx("button",{onClick:()=>l("folder"),disabled:!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create Folder"}),t.jsx("button",{onClick:()=>l("file"),disabled:!n.trim(),className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create File"})]}),Lt=({newItemName:n,setNewItemName:r,setShowRenameDialog:c,renameItem:l,showRenameDialog:h})=>t.jsx(ke,{title:"Rename Item",inputValue:n,onInputChange:d=>r(d.target.value),onCancel:()=>{c(null),r("")},onKeyDown:d=>{d.key==="Enter"&&n.trim()?l(h,n):d.key==="Escape"&&(c(null),r(""))},children:t.jsx("button",{onClick:()=>l(h,n),disabled:!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Rename"})}),Ot=({items:n,selectedItems:r,setSelectedItems:c,navigateToFolder:l,setShowContextMenu:h,handleDragStart:d,handleFolderDragOver:f,handleFolderDragLeave:u,handleFolderDrop:x,dragOverFolder:N,selectionBox:C})=>t.jsx("div",{className:"mb-8",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1rem",alignItems:"start"},children:n.map(i=>t.jsx("div",{"data-item-id":i.id,className:`p-3 border rounded-lg cursor-pointer hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 ${r.has(i.id)?"bg-blue-50 border-blue-300 shadow-sm":"border-gray-200"} ${N===i.id?"bg-blue-100 border-blue-400":""}`,onClick:p=>{if(p.stopPropagation(),p.ctrlKey||p.metaKey){const S=new Set(r);S.has(i.id)?S.delete(i.id):S.add(i.id),c(S)}else if(p.shiftKey&&r.size>0){const S=n.map(w=>w.id),F=Array.from(r).pop(),o=S.indexOf(F||""),m=S.indexOf(i.id);if(o>=0){const w=Math.min(o,m),M=Math.max(o,m),k=S.slice(w,M+1);c(new Set(k))}}else c(new Set([i.id]))},onDoubleClick:p=>{p.stopPropagation(),i.type==="folder"&&l(i.id)},onContextMenu:p=>{p.preventDefault(),p.stopPropagation(),r.has(i.id)||c(new Set([i.id])),h({x:p.clientX,y:p.clientY,itemId:i.id})},draggable:!0,onDragStart:p=>d&&d(i.id,p),onDragOver:p=>i.type==="folder"&&f&&f(i.id,p),onDragLeave:()=>i.type==="folder"&&u&&u(),onDrop:p=>i.type==="folder"&&x&&x(i.id,p),children:t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx("div",{className:"w-12 h-12 flex items-center justify-center mb-2",children:re.cloneElement(Ne(i),{className:`w-8 h-8 ${r.has(i.id)?"drop-shadow-sm":""}`})}),t.jsx("span",{className:"text-sm truncate w-full font-medium",title:i.name,children:i.name}),i.type==="file"&&i.size!==void 0&&t.jsx("span",{className:"text-xs text-gray-500 mt-1",children:At(i.size)})]})},i.id))}),zt=({fileSystem:n,expandedFolders:r,selectedItems:c,navigateToQuickAccess:l,toggleFolder:h,setSelectedItems:d,handleFolderDragOver:f,handleFolderDragLeave:u,handleFolderDrop:x,dragOverFolder:N})=>{const C=a.useMemo(()=>{var o;return(o=n.children)==null?void 0:o.find(m=>m.name===".vfsignore"&&m.type==="file")},[n]),i=a.useMemo(()=>!C||!C.content?[]:C.content.split(/\r?\n/).map(o=>o.trim()).filter(o=>o&&!o.startsWith("#")),[C]),p=a.useMemo(()=>i.map(o=>{const m=o.endsWith("/");let M=(m?o.slice(0,-1):o).replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,".");return m&&(M=`${M}(/.*)?`),new RegExp(`^${M}$`)}),[i]),S=a.useCallback(o=>o.filter(m=>!(m.name===".vfsignore"||!le.showHiddenFiles&&m.name.startsWith(".")||p.some(w=>w.test(m.id)))).sort((m,w)=>m.type!==w.type?m.type==="folder"?-1:1:m.name.localeCompare(w.name)),[p]),F=(o,m=0)=>{const w=r.has(o.id),M=c.has(o.id),k=o.type==="folder"&&o.children&&o.children.length>0,E=N===o.id;return t.jsxs("div",{children:[t.jsxs("div",{className:`flex items-center gap-2 py-1 px-2 hover:bg-gray-100 cursor-pointer transition-colors ${M?"bg-blue-100 text-blue-700":""} ${E?"bg-blue-100 border-blue-400":""}`,style:{paddingLeft:`${m*20+4}px`},onClick:()=>{o.type==="folder"&&(h(o.id),d(new Set([o.id])))},onDoubleClick:()=>{o.type==="folder"&&l(o.id)},onDragOver:D=>o.type==="folder"&&f&&f(o.id,D),onDragLeave:()=>o.type==="folder"&&u&&u(),onDrop:D=>o.type==="folder"&&x&&x(o.id,D),children:[o.type==="folder"&&t.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:k?w?t.jsx(tt,{className:"w-3 h-3 text-gray-500"}):t.jsx(ie,{className:"w-3 h-3 text-gray-500"}):t.jsx("div",{className:"w-3 h-3"})}),Ne(o),t.jsx("span",{className:"text-sm truncate flex-1",children:o.name})]}),o.type==="folder"&&w&&o.children&&t.jsx("div",{children:S(o.children).map(D=>F(D,m+1))})]},o.id)};return t.jsxs("div",{className:"w-64 bg-gray-50 border-r border-gray-200 overflow-y-auto",children:[t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Quick Access"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("button",{onClick:()=>l("desktop"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:o=>f&&f("desktop",o),onDragLeave:()=>u&&u(),onDrop:o=>x&&x("desktop",o),children:[t.jsx(Ce,{className:"w-4 h-4 text-blue-500"}),"Desktop"]}),t.jsxs("button",{onClick:()=>l("documents"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:o=>f&&f("documents",o),onDragLeave:()=>u&&u(),onDrop:o=>x&&x("documents",o),children:[t.jsx(se,{className:"w-4 h-4 text-blue-500"}),"Documents"]}),t.jsxs("button",{onClick:()=>l("downloads"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:o=>f&&f("downloads",o),onDragLeave:()=>u&&u(),onDrop:o=>x&&x("downloads",o),children:[t.jsx(st,{className:"w-4 h-4 text-blue-500"}),"Downloads"]})]})]}),t.jsxs("div",{className:"px-4 pb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:"This PC"}),t.jsx("div",{className:"text-sm",children:F(n)})]})]})},Bt=({isAuthenticated:n,user:r,handleGithubAuth:c,handleLogout:l})=>t.jsxs("div",{className:"h-8 bg-gray-900 text-white flex items-center justify-between px-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(se,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"File Explorer"})]}),t.jsx("div",{className:"flex items-center gap-2",children:n?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:r==null?void 0:r.avatar_url,alt:"Avatar",className:"w-5 h-5 rounded-full border border-gray-600"}),t.jsx("span",{className:"text-xs font-medium",children:r==null?void 0:r.name}),t.jsx("button",{onClick:l,className:"p-1 hover:bg-gray-700 rounded transition-colors",title:"Sign out",children:t.jsx(ut,{className:"w-3 h-3"})})]}):t.jsxs("button",{onClick:c,className:"flex items-center gap-1 px-2 py-1 bg-gray-800 hover:bg-gray-700 rounded text-xs transition-colors",children:[t.jsx(ct,{className:"w-3 h-3"}),"Sign in with GitHub"]})})]}),Ut=({currentPath:n,breadcrumbs:r,navigateUp:c,navigateToPathLevel:l,showNewItemDialog:h,fileInputRef:d,isAuthenticated:f,handleGithubAuth:u})=>t.jsxs("div",{className:"h-12 bg-gray-50 border-b border-gray-200 flex items-center px-4 gap-2",children:[t.jsx("button",{onClick:c,disabled:n.length<=1,className:"p-2 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Go up",children:t.jsx(ie,{className:"w-4 h-4 rotate-180"})}),t.jsx("button",{className:"p-2 hover:bg-gray-200 rounded transition-colors",title:"Refresh",children:t.jsx(at,{className:"w-4 h-4"})}),t.jsx("div",{className:"flex-1 mx-4",children:t.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded px-3 py-1.5",children:[t.jsx(Ce,{className:"w-4 h-4 text-gray-400 mr-2"}),t.jsx("button",{onClick:()=>l(0),className:"text-sm hover:text-blue-600 transition-colors",children:"This PC"}),r.map((x,N)=>t.jsxs("span",{className:"flex items-center",children:[t.jsx(ie,{className:"w-3 h-3 text-gray-400 mx-1"}),t.jsx("button",{onClick:()=>l(N+1),className:"text-sm text-gray-600 hover:text-blue-600 transition-colors",children:x.name})]},x.id))]})}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("button",{onClick:()=>f?h():u(),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm transition-colors disabled:opacity-50",title:f?"Create new item":"Sign in to create items",children:[t.jsx(ot,{className:"w-4 h-4"}),"New"]}),t.jsx("button",{onClick:()=>{var x;return f?(x=d.current)==null?void 0:x.click():u()},className:"p-2 hover:bg-gray-200 rounded transition-colors",title:f?"Upload files":"Sign in to upload files",children:t.jsx(ft,{className:"w-4 h-4"})})]})]}),Ht=()=>{var ge,be;const[n,r]=a.useState(["root"]),[c,l]=a.useState(new Set),[h,d]=a.useState(new Set(["root"])),[f,u]=a.useState(!1),[x,N]=a.useState(null),[C,i]=a.useState(null),[p,S]=a.useState(!1),[F,o]=a.useState(null),[m,w]=a.useState(""),[M,k]=a.useState(null),[E,D]=a.useState(null),[z,B]=a.useState(null),[ee,W]=a.useState(!1),[te,I]=a.useState(!1),[q,U]=a.useState(!1),$=a.useRef(null),P=a.useRef(null),R=Z(e=>e.fs),v=Z(e=>e.init),y=Z(e=>e.addItems),T=Z(e=>e.renameItem),A=Z(e=>e.deleteItem),H=Z(e=>e.moveItem),L=a.useMemo(()=>{var e;return(e=R.children)==null?void 0:e.find(s=>s.name===".vfsignore"&&s.type==="file")},[R]),V=a.useMemo(()=>!L||!L.content?[]:L.content.split(/\r?\n/).map(e=>e.trim()).filter(e=>e&&!e.startsWith("#")),[L]),ue=a.useMemo(()=>V.map(e=>{const s=e.endsWith("/");let b=(s?e.slice(0,-1):e).replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,".");return s&&(b=`${b}(/.*)?`),new RegExp(`^${b}$`)}),[V]),de=a.useMemo(()=>{var g;let e=R;for(let b=1;b<n.length&&(e=(g=e.children)==null?void 0:g.find(j=>j.id===n[b]),!!e);b++);return((e==null?void 0:e.children)||[]).filter(b=>!(b.name===".vfsignore"||!le.showHiddenFiles&&b.name.startsWith(".")||ue.some(j=>j.test(b.id))))},[R,n,ue,le.showHiddenFiles]),fe=a.useMemo(()=>[...de].sort((e,s)=>e.type!==s.type?e.type==="folder"?-1:1:e.name.localeCompare(s.name)),[de]);a.useEffect(()=>{v().then(()=>d(new Set(["root"])))},[v]);const{DragSelection:Ee}=Ft({onSelectionChange:Te,isEnabled:te,shouldStartSelecting:e=>{if(e instanceof HTMLElement){let s=e;for(;s&&s!==P.current;){if(s.hasAttribute("data-item-id"))return!1;s=s.parentElement}return!0}return!1},selectionProps:{style:{border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",position:"absolute",zIndex:1e3}}}),oe=a.useCallback(e=>{var g;let s=R;for(let b=1;b<e.length;b++){const j=(g=s.children)==null?void 0:g.find(K=>K.id===e[b]);if(!j)return null;s=j}return s},[R]),De=a.useCallback(()=>oe(n),[oe,n]),Pe=a.useCallback(e=>{const s=[...n,e];r(s),l(new Set),d(g=>new Set([...g,e]))},[n]),Re=a.useCallback(()=>{n.length>1&&(r(n.slice(0,-1)),l(new Set))},[n]),Me=a.useCallback(e=>{const s=n.slice(0,e+1);r(s),l(new Set)},[n]),Fe=a.useCallback(e=>{d(s=>{const g=new Set(s);return g.has(e)?g.delete(e):g.add(e),g})},[]);function Te(e){if(!P.current||!e.width||!e.height)return;B(e);const s=P.current.querySelectorAll("[data-item-id]"),g=new Set;s.forEach(b=>{const j=b.getBoundingClientRect(),K=b.getAttribute("data-item-id");if(!K)return;const X=P.current.getBoundingClientRect(),O={left:j.left-X.left,top:j.top-X.top,right:j.right-X.left,bottom:j.bottom-X.top};!(O.right<e.left||O.left>e.left+e.width||O.bottom<e.top||O.top>e.top+e.height)&&g.add(K)}),l(g)}const Ae=e=>{e.preventDefault(),U(!0)},Ie=e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy",U(!0)},$e=e=>{e.preventDefault(),U(!1)},Le=async e=>{var g;e.preventDefault(),U(!1);const s=Array.from(e.dataTransfer.files);if(s.length>0&&!f&&(ae(),Y.success("Auto-authenticated for file upload")),s.length>0)try{const b=[];for(const j of s){const K=((g=j.name.split(".").pop())==null?void 0:g.toLowerCase())??"",X=Tt.includes(K);let O;X?O=await new Promise((ye,Ke)=>{const Q=new FileReader;Q.onload=()=>ye(Q.result),Q.onerror=()=>Ke(Q.error),Q.readAsText(j)}):O="[Binary file content]",b.push({id:`file_${Date.now()}_${Math.random().toString(36).slice(2,9)}`,name:j.name,type:"file",size:j.size,content:O})}y(n,b),Y.success(`${b.length} file(s) uploaded`)}catch(b){console.error("Error uploading files:",b),Y.error("Failed to upload files")}},me=e=>{if(!m.trim()||!f)return;const s={id:`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:m.trim(),type:e,...e==="folder"?{children:[]}:{size:0}};y(n,[s]),Y.success(`${e==="folder"?"Folder":"File"} created`),w(""),S(!1)},Oe=(e,s)=>{!s.trim()||!f||(T(n,e,s.trim()),Y.success("Item renamed"),o(null),w(""))},ze=e=>{f&&(A(n,e),Y.success("Item deleted"),l(new Set),i(null))},ae=()=>{u(!0),N({login:"developer-user",avatar_url:"https://github.com/github.png",name:"Developer User"})},Be=()=>{u(!1),N(null),l(new Set)},Ue=e=>{const s=ce(R,e);s&&(r(s),l(new Set))},He=e=>{e.key==="Enter"&&p&&m.trim()?me("folder"):e.key==="Escape"&&(S(!1),o(null),i(null))},Ve=()=>{i(null)},_e=(e,s)=>{s.stopPropagation(),f&&(D(e),s.dataTransfer.setData("text/plain",e),s.dataTransfer.effectAllowed="move",c.has(e)||l(new Set([e])))},pe=(e,s)=>{s.preventDefault(),s.stopPropagation(),E&&E!==e&&(k(e),s.dataTransfer.dropEffect="move")},he=()=>{k(null)},xe=(e,s)=>{if(s.preventDefault(),s.stopPropagation(),k(null),!E||!f||E===e)return;const g=ce(R,e);g&&(H(n,E,g),D(null))},Ge=e=>{if(e.target===P.current||e.target===e.currentTarget)I(!0);else{let s=e.target,g=!1;for(;s&&s!==P.current;){if(s.hasAttribute("data-item-id")){g=!0;break}s=s.parentElement}g||I(!0)}W(!0)},We=()=>{W(!1),I(!1),B(null)},_=De(),qe=n.slice(1).reduce((e,s,g)=>{const b=n.slice(0,g+2),j=oe(b);return j&&e.push({id:s,name:j.name,path:b}),e},[]);return t.jsxs("div",{className:"h-screen flex flex-col bg-white",onClick:Ve,children:[t.jsx(Bt,{isAuthenticated:f,user:x,handleGithubAuth:ae,handleLogout:Be}),t.jsx(Ut,{currentPath:n,breadcrumbs:qe,navigateUp:Re,navigateToPathLevel:Me,showNewItemDialog:()=>S(!0),fileInputRef:$,isAuthenticated:f,handleGithubAuth:ae}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsx(zt,{fileSystem:R,expandedFolders:h,selectedItems:c,navigateToQuickAccess:Ue,toggleFolder:Fe,setSelectedItems:l,handleFolderDragOver:pe,handleFolderDragLeave:he,handleFolderDrop:xe,dragOverFolder:M}),t.jsxs("div",{className:`flex-1 p-6 overflow-y-auto bg-white transition-colors duration-200 relative border-2 border-dashed ${q?"border-blue-400 bg-blue-50":"border-transparent"}`,onDragEnter:Ae,onDragOver:Ie,onDragLeave:$e,onDrop:Le,onMouseDown:Ge,onMouseUp:We,ref:P,children:[t.jsx(Ee,{}),_&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-1",children:_.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[((ge=_.children)==null?void 0:ge.length)||0," item",(((be=_.children)==null?void 0:be.length)||0)!==1?"s":""]})]}),fe.length>0?t.jsx(Ot,{items:fe,selectedItems:c,setSelectedItems:l,navigateToFolder:Pe,setShowContextMenu:i,handleDragStart:_e,handleFolderDragOver:pe,handleFolderDragLeave:he,handleFolderDrop:xe,dragOverFolder:M,selectionBox:z}):t.jsxs("div",{className:"text-center text-gray-500 mb-8",children:[t.jsx(se,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"This folder is empty"})]})]})]})]}),t.jsx("input",{type:"file",ref:$,multiple:!0,className:"hidden",onChange:e=>{const s=Array.from(e.target.files||[]);console.log("Files selected for upload:",s)}}),C&&t.jsx(It,{position:{x:C.x,y:C.y},itemId:C.itemId,onRename:e=>{var g;const s=(g=_==null?void 0:_.children)==null?void 0:g.find(b=>b.id===e);s&&(w(s.name),o(e))},onDelete:ze,setShowContextMenu:i}),p&&t.jsx($t,{newItemName:m,setNewItemName:w,setShowNewItemDialog:S,createNewItem:me,handleKeyDown:He}),F&&t.jsx(Lt,{newItemName:m,setNewItemName:w,setShowRenameDialog:o,renameItem:Oe,showRenameDialog:F})]})},Jt={id:ve.id,manifest:ve,init:async()=>{},render:()=>t.jsx(Ht,{}),onOpen:()=>{},onClose:()=>{}};export{Jt as default};
