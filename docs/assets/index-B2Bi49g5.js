import{r as i,j as e}from"./index-Dalxj5Wh.js";import{x as p,y as d}from"./MacroContext-Dt3zq0Vi.js";const y=()=>{const[n,l]=i.useState("0"),[u,g]=i.useState(null),[b,m]=i.useState(null),[k,c]=i.useState(!1),[C,x]=i.useState(!1),[r,h]=i.useState(!1);i.useEffect(()=>((async()=>{try{if(await p.isPluginRegistered("calculator"))h(!0),console.log("Calculator worker already registered");else{let o;d.workerEntrypoint?o=`/worker/${d.workerEntrypoint}`:console.error("No workerEntrypoint defined in manifest"),o&&(await p.registerPlugin(d.id,o)?(h(!0),console.log("Calculator worker registered successfully")):console.error("Failed to register calculator worker"))}}catch(s){console.error("Error initializing calculator worker:",s)}})(),()=>{}),[]);const t=a=>{k?(l(a),c(!1)):l(n==="0"?a:n+a)},j=()=>{if(k){l("0."),c(!1);return}n.includes(".")||l(n+".")},w=()=>{l("0"),g(null),m(null),c(!1)},f=async a=>{const s=parseFloat(n);if(u===null)g(s);else if(b){x(!0);try{const o=await p.calculate(u,s,b);l(String(o)),g(o)}catch(o){console.error("Calculator worker error:",o),l("Error")}finally{x(!1)}}c(!0),m(a)},N=async()=>{if(u===null||b===null)return;const a=parseFloat(n);x(!0);try{const s=await p.calculate(u,a,b);l(String(s)),g(s),m(null),c(!0)}catch(s){console.error("Calculator worker error:",s),l("Error")}finally{x(!1)}};return e.jsxs("div",{className:"p-4 calculator-root",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Worker Calculator"}),C&&e.jsx("div",{className:"text-xs text-blue-500",children:"Computing..."}),!r&&e.jsx("div",{className:"text-xs text-amber-500",children:"Initializing worker..."})]}),e.jsx("div",{className:"bg-card p-2 mb-2 text-right text-xl h-10 overflow-hidden text-foreground border border-border",children:n}),e.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[e.jsx("button",{onClick:w,className:"col-span-2 bg-red-500 text-white p-2",disabled:!r,children:"AC"}),e.jsx("button",{onClick:()=>f("/"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"/"}),e.jsx("button",{onClick:()=>f("*"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"Ã—"}),e.jsx("button",{onClick:()=>t("7"),className:"bg-card p-2 text-foreground",disabled:!r,children:"7"}),e.jsx("button",{onClick:()=>t("8"),className:"bg-card p-2 text-foreground",disabled:!r,children:"8"}),e.jsx("button",{onClick:()=>t("9"),className:"bg-card p-2 text-foreground",disabled:!r,children:"9"}),e.jsx("button",{onClick:()=>f("-"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"-"}),e.jsx("button",{onClick:()=>t("4"),className:"bg-card p-2 text-foreground",disabled:!r,children:"4"}),e.jsx("button",{onClick:()=>t("5"),className:"bg-card p-2 text-foreground",disabled:!r,children:"5"}),e.jsx("button",{onClick:()=>t("6"),className:"bg-card p-2 text-foreground",disabled:!r,children:"6"}),e.jsx("button",{onClick:()=>f("+"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"+"}),e.jsx("button",{onClick:()=>t("1"),className:"bg-card p-2 text-foreground",disabled:!r,children:"1"}),e.jsx("button",{onClick:()=>t("2"),className:"bg-card p-2 text-foreground",disabled:!r,children:"2"}),e.jsx("button",{onClick:()=>t("3"),className:"bg-card p-2 text-foreground",disabled:!r,children:"3"}),e.jsx("button",{onClick:N,className:"bg-blue-500 text-white p-2 row-span-2",disabled:!r,children:"="}),e.jsx("button",{onClick:()=>t("0"),className:"bg-card p-2 col-span-2 text-foreground",disabled:!r,children:"0"}),e.jsx("button",{onClick:j,className:"bg-card p-2 text-foreground",disabled:!r,children:"."})]})]})},F={id:d.id,manifest:d,init:async()=>{console.log("Calculator plugin initialized")},render:()=>e.jsx(y,{})};export{F as default};
