import{c as I,i as Xe,r as o,R as re,J as Ye,j as t,h as Y}from"./index-D-dJ6MFG.js";import{F as se,S as Ze,a as Je,u as Z}from"./fileSystem-BhDkNbN2.js";import{ideSettings as le}from"./esbuild-settings-Bzyyd_qg.js";import{a9 as Qe,aa as et,ab as tt,b as nt,C as ie,ac as ve}from"./MacroContext-DNX_Eazx.js";import{H as Ce}from"./house-WsJQWdRe.js";import{R as rt}from"./refresh-cw-uKs3lsiI.js";import"./monaco-editor-Dq6WuQlL.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=I("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=I("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=I("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=I("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=I("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=I("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=I("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=I("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=I("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=I("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var ne={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function pt(n,r){return n+r.charAt(0).toUpperCase()+r.substring(1)}var mt=["Webkit","ms","Moz","O"];Object.keys(ne).forEach(function(n){mt.forEach(function(r){ne[pt(r,n)]=ne[n]})});var xt={isUnitlessNumber:ne},gt=xt,bt=/^ms-/,yt=/([A-Z])/g;function vt(n){return n.replace(yt,"-$1").toLowerCase()}function wt(n){return vt(n).replace(bt,"-ms-")}var jt=wt,St=gt.isUnitlessNumber,Ct=jt,Nt=Array.isArray,we=Object.keys,kt=/^(normal|none|(\b(url\([^)]*\)|chapter_counter|attr\([^)]*\)|(no-)?(open|close)-quote|inherit)((\b\s*)|$|\s+))+)$/;function je(n,r){return!St[n]&&typeof r=="number"?r=""+r+"px":n==="content"&&!kt.test(r)&&(r="'"+r.replace(/'/g,"\\'")+"'"),Ct(n)+": "+r+";  "}function Et(n){var r="";if(!n||we(n).length===0)return r;for(var c=we(n),l=0,m=c.length;l<m;l++){var d=c[l],f=n[d];if(Nt(f))for(var u=0,x=f.length;u<x;u++)r+=je(d,f[u]);else r+=je(d,f)}return r}var Mt=Et;const Se=Xe(Mt);function J(){return J=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var c=arguments[r];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(n[l]=c[l])}return n},J.apply(this,arguments)}const Dt=["style"],Pt=o.forwardRef((n,r)=>{let{style:c={}}=n,l=function(u,x){if(u==null)return{};var N,C,i={},p=Object.keys(u);for(C=0;C<p.length;C++)x.indexOf(N=p[C])>=0||(i[N]=u[N]);return i}(n,Dt);const m=o.useRef(null),d=o.useRef(null),[,f]=o.useState(0);return o.useImperativeHandle(r,()=>({getBoundingClientRect:()=>{var u;return(u=m.current)==null?void 0:u.getBoundingClientRect()},getParentBoundingClientRect:()=>{var u,x;return m==null||(u=m.current)==null||(x=u.parentElement)==null?void 0:x.getBoundingClientRect()},drawSelectionBox:u=>{requestAnimationFrame(()=>{if(d.current){const x=J({border:"1px solid #4C85D8",background:"rgba(155, 193, 239, 0.4)",position:"absolute",pointerEvents:"none"},c,{top:u.top,left:u.left,width:u.width,height:u.height});d.current.style.cssText=Se(x)}})},clearSelectionBox:()=>{requestAnimationFrame(()=>{d.current&&(d.current.style.cssText=Se({top:0,left:0,width:0,height:0}))})}})),o.useEffect(()=>{f(u=>u+1)},[]),re.createElement("div",{ref:m},m.current?Ye.createPortal(re.createElement("div",J({ref:d},l)),m.current):null)});function Rt(n){return(r=>r.width*r.height)(n)>10}function Tt(n){const{onSelectionChange:r,onSelectionEnd:c,onSelectionStart:l,isEnabled:m=!0,selectionProps:d={},eventsElement:f,shouldStartSelecting:u,isValidSelectionStart:x}=n||{},N=o.useRef(null),{cancelCurrentSelection:C}=function({containerRef:i,onSelectionChange:p,onSelectionStart:S,onSelectionEnd:T,isEnabled:a=!0,eventsElement:h,shouldStartSelecting:w,isValidSelectionStart:R=Rt}){const k=o.useRef(null),E=o.useRef(null),M=o.useRef(!1),B=o.useRef(p),H=o.useRef(S),ee=o.useRef(T),q=o.useRef(),te=o.useRef(a);B.current=o.useCallback(v=>{q.current=p?requestAnimationFrame(()=>{p(v)}):void 0},[p]),H.current=S,ee.current=T,te.current=a;const $=o.useCallback(()=>{var v;k.current=null,E.current=null,M.current=!1,(v=i.current)==null||v.clearSelectionBox(),typeof q.current=="number"&&cancelAnimationFrame(q.current)},[i]),W=o.useCallback((v,y)=>{var A,F,V;return y||(y=(V=i.current)==null?void 0:V.getParentBoundingClientRect()),{x:v.clientX-(typeof((A=y)==null?void 0:A.left)=="number"?y.left:0),y:v.clientY-(typeof((F=y)==null?void 0:F.top)=="number"?y.top:0)}},[i]),U=o.useCallback((v,y)=>{if(k.current&&E.current){if(!y)return;const F=(({startPoint:O,endPoint:_})=>({left:Math.min(O.x,_.x),top:Math.min(O.y,_.y),width:Math.abs(O.x-_.x),height:Math.abs(O.y-_.y)}))({startPoint:k.current,endPoint:E.current}),V=J({},F,{top:F.top+((y==null?void 0:y.top)||0),left:F.left+((y==null?void 0:y.left)||0)});var A;R(F)?(M.current||(H!=null&&H.current&&H.current(v),M.current=!0),(A=i.current)==null||A.drawSelectionBox(F),B.current==null||B.current(V)):M.current&&(B.current==null||B.current(V))}else $()},[$,i]),L=o.useCallback(v=>{var y;if(!k.current)return;const A=(y=i.current)==null?void 0:y.getParentBoundingClientRect();E.current=W(v,A),U(v,A)},[U,W,i]),D=o.useCallback(v=>{var y;v.button===0&&(E.current&&(ee.current==null||ee.current(v)),$(),document.body.style.removeProperty("user-select"),document.body.style.removeProperty("-webkit-user-select"),(h||document.body).removeEventListener("mousemove",L),(y=window)==null||y.removeEventListener("mouseup",D))},[h,$,L]),P=o.useCallback(v=>{if(v.button===0&&te.current){var y;if(typeof w=="function"&&!w(v.target))return;document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",k.current=W(v),(h||document.body).addEventListener("mousemove",L),(y=window)==null||y.addEventListener("mouseup",D)}},[h,W,L,D]);return o.useEffect(()=>((h||document.body).addEventListener("mousedown",P),()=>{(h||document.body).removeEventListener("mousedown",P),(h||document.body).removeEventListener("mousemove",L),window.removeEventListener("mouseup",D)}),[h,P,L,D]),{cancelCurrentSelection:$}}({containerRef:N,onSelectionEnd:c,onSelectionStart:l,onSelectionChange:r,isEnabled:m,eventsElement:f,shouldStartSelecting:u,isValidSelectionStart:x});return{cancelCurrentSelection:C,DragSelection:o.useCallback(()=>re.createElement(Pt,J({ref:N},d)),[])}}const At=["txt","js","jsx","ts","tsx","md","css","html","json","csv","xml","yml","yaml","py","c","h","cpp","cc","hpp"],Ne=n=>{var c;if(n.type==="folder")return t.jsx(se,{className:"w-4 h-4 text-blue-500"});switch((c=n.name.split(".").pop())==null?void 0:c.toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return t.jsx(tt,{className:"w-4 h-4 text-green-500"});case"txt":case"doc":case"docx":case"pdf":case"rtf":return t.jsx(Je,{className:"w-4 h-4 text-red-500"});case"mp3":case"wav":case"flac":case"ogg":return t.jsx(et,{className:"w-4 h-4 text-purple-500"});case"mp4":case"avi":case"mkv":case"mov":case"wmv":return t.jsx(ht,{className:"w-4 h-4 text-orange-500"});case"zip":case"rar":case"7z":case"tar":case"gz":return t.jsx(st,{className:"w-4 h-4 text-yellow-500"});case"js":case"ts":case"html":case"css":case"py":case"java":case"cpp":case"c":case"php":return t.jsx(Qe,{className:"w-4 h-4 text-cyan-500"});case"exe":case"msi":case"dmg":return t.jsx(Ze,{className:"w-4 h-4 text-indigo-500"});default:return t.jsx(ot,{className:"w-4 h-4 text-gray-500"})}},Ft=n=>{if(n===0)return"0 Bytes";const r=1024,c=["Bytes","KB","MB","GB","TB"],l=Math.floor(Math.log(n)/Math.log(r));return parseFloat((n/Math.pow(r,l)).toFixed(2))+" "+c[l]},ce=(n,r,c=["root"])=>{if(n.id===r)return c;if(n.children)for(const l of n.children){const m=ce(l,r,[...c,l.id]);if(m)return m}return null},It=({position:n,itemId:r,onRename:c,onDelete:l,setShowContextMenu:m})=>t.jsxs("div",{className:"fixed bg-white border border-gray-200 rounded-lg shadow-xl py-2 z-50 min-w-48",style:{left:n.x,top:n.y},children:[t.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-3 transition-colors",onClick:d=>{d.stopPropagation(),c(r),m(null)},children:[t.jsx(ct,{className:"w-4 h-4"}),"Rename"]}),t.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-3 text-red-600 hover:bg-red-50 transition-colors",onClick:d=>{d.stopPropagation(),l(r)},children:[t.jsx(dt,{className:"w-4 h-4"}),"Delete"]})]}),ke=({title:n,inputValue:r,onInputChange:c,onCancel:l,onKeyDown:m,children:d})=>t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:n}),t.jsx("input",{type:"text",value:r,onChange:c,onKeyDown:m,placeholder:"Enter name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),t.jsxs("div",{className:"flex gap-2 justify-end",children:[t.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),d]})]})}),$t=({newItemName:n,setNewItemName:r,setShowNewItemDialog:c,createNewItem:l,handleKeyDown:m})=>t.jsxs(ke,{title:"Create New Item",inputValue:n,onInputChange:d=>r(d.target.value),onCancel:()=>{c(!1),r("")},onKeyDown:m,children:[t.jsx("button",{onClick:()=>l("folder"),disabled:!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create Folder"}),t.jsx("button",{onClick:()=>l("file"),disabled:!n.trim(),className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create File"})]}),Lt=({newItemName:n,setNewItemName:r,setShowRenameDialog:c,renameItem:l,showRenameDialog:m})=>t.jsx(ke,{title:"Rename Item",inputValue:n,onInputChange:d=>r(d.target.value),onCancel:()=>{c(null),r("")},onKeyDown:d=>{d.key==="Enter"&&n.trim()?l(m,n):d.key==="Escape"&&(c(null),r(""))},children:t.jsx("button",{onClick:()=>l(m,n),disabled:!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Rename"})}),Ot=({items:n,selectedItems:r,setSelectedItems:c,navigateToFolder:l,setShowContextMenu:m,handleDragStart:d,handleFolderDragOver:f,handleFolderDragLeave:u,handleFolderDrop:x,dragOverFolder:N,selectionBox:C})=>t.jsx("div",{className:"mb-8",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1rem",alignItems:"start"},children:n.map(i=>t.jsx("div",{"data-item-id":i.id,className:`p-3 border rounded-lg cursor-pointer hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 ${r.has(i.id)?"bg-blue-50 border-blue-300 shadow-sm":"border-gray-200"} ${N===i.id?"bg-blue-100 border-blue-400":""}`,onClick:p=>{if(p.stopPropagation(),p.ctrlKey||p.metaKey){const S=new Set(r);S.has(i.id)?S.delete(i.id):S.add(i.id),c(S)}else if(p.shiftKey&&r.size>0){const S=n.map(w=>w.id),T=Array.from(r).pop(),a=S.indexOf(T||""),h=S.indexOf(i.id);if(a>=0){const w=Math.min(a,h),R=Math.max(a,h),k=S.slice(w,R+1);c(new Set(k))}}else c(new Set([i.id]))},onDoubleClick:p=>{p.stopPropagation(),i.type==="folder"&&l(i.id)},onContextMenu:p=>{p.preventDefault(),p.stopPropagation(),r.has(i.id)||c(new Set([i.id])),m({x:p.clientX,y:p.clientY,itemId:i.id})},draggable:!0,onDragStart:p=>d&&d(i.id,p),onDragOver:p=>i.type==="folder"&&f&&f(i.id,p),onDragLeave:()=>i.type==="folder"&&u&&u(),onDrop:p=>i.type==="folder"&&x&&x(i.id,p),children:t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx("div",{className:"w-12 h-12 flex items-center justify-center mb-2",children:re.cloneElement(Ne(i),{className:`w-8 h-8 ${r.has(i.id)?"drop-shadow-sm":""}`})}),t.jsx("span",{className:"text-sm truncate w-full font-medium",title:i.name,children:i.name}),i.type==="file"&&i.size!==void 0&&t.jsx("span",{className:"text-xs text-gray-500 mt-1",children:Ft(i.size)})]})},i.id))}),zt=({fileSystem:n,expandedFolders:r,selectedItems:c,navigateToQuickAccess:l,toggleFolder:m,setSelectedItems:d,handleFolderDragOver:f,handleFolderDragLeave:u,handleFolderDrop:x,dragOverFolder:N})=>{const C=o.useMemo(()=>{var a;return(a=n.children)==null?void 0:a.find(h=>h.name===".vfsignore"&&h.type==="file")},[n]),i=o.useMemo(()=>!C||!C.content?[]:C.content.split(/\r?\n/).map(a=>a.trim()).filter(a=>a&&!a.startsWith("#")),[C]),p=o.useMemo(()=>i.map(a=>{const h=a.endsWith("/");let R=(h?a.slice(0,-1):a).replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,".");return h&&(R=`${R}(/.*)?`),new RegExp(`^${R}$`)}),[i]),S=o.useCallback(a=>a.filter(h=>!(h.name===".vfsignore"||!le.showHiddenFiles&&h.name.startsWith(".")||p.some(w=>w.test(h.id)))).sort((h,w)=>h.type!==w.type?h.type==="folder"?-1:1:h.name.localeCompare(w.name)),[p]),T=(a,h=0)=>{const w=r.has(a.id),R=c.has(a.id),k=a.type==="folder"&&a.children&&a.children.length>0,E=N===a.id;return t.jsxs("div",{children:[t.jsxs("div",{className:`flex items-center gap-2 py-1 px-2 hover:bg-gray-100 cursor-pointer transition-colors ${R?"bg-blue-100 text-blue-700":""} ${E?"bg-blue-100 border-blue-400":""}`,style:{paddingLeft:`${h*20+4}px`},onClick:()=>{a.type==="folder"&&(m(a.id),d(new Set([a.id])))},onDoubleClick:()=>{a.type==="folder"&&l(a.id)},onDragOver:M=>a.type==="folder"&&f&&f(a.id,M),onDragLeave:()=>a.type==="folder"&&u&&u(),onDrop:M=>a.type==="folder"&&x&&x(a.id,M),children:[a.type==="folder"&&t.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:k?w?t.jsx(nt,{className:"w-3 h-3 text-gray-500"}):t.jsx(ie,{className:"w-3 h-3 text-gray-500"}):t.jsx("div",{className:"w-3 h-3"})}),Ne(a),t.jsx("span",{className:"text-sm truncate flex-1",children:a.name})]}),a.type==="folder"&&w&&a.children&&t.jsx("div",{children:S(a.children).map(M=>T(M,h+1))})]},a.id)};return t.jsxs("div",{className:"w-64 bg-gray-50 border-r border-gray-200 overflow-y-auto",children:[t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Quick Access"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("button",{onClick:()=>l("desktop"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:a=>f&&f("desktop",a),onDragLeave:()=>u&&u(),onDrop:a=>x&&x("desktop",a),children:[t.jsx(Ce,{className:"w-4 h-4 text-blue-500"}),"Desktop"]}),t.jsxs("button",{onClick:()=>l("documents"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:a=>f&&f("documents",a),onDragLeave:()=>u&&u(),onDrop:a=>x&&x("documents",a),children:[t.jsx(se,{className:"w-4 h-4 text-blue-500"}),"Documents"]}),t.jsxs("button",{onClick:()=>l("downloads"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:a=>f&&f("downloads",a),onDragLeave:()=>u&&u(),onDrop:a=>x&&x("downloads",a),children:[t.jsx(at,{className:"w-4 h-4 text-blue-500"}),"Downloads"]})]})]}),t.jsxs("div",{className:"px-4 pb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:"This PC"}),t.jsx("div",{className:"text-sm",children:T(n)})]})]})},Bt=({isAuthenticated:n,user:r,handleGithubAuth:c,handleLogout:l})=>t.jsxs("div",{className:"h-8 bg-gray-900 text-white flex items-center justify-between px-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(se,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"File Explorer"})]}),t.jsx("div",{className:"flex items-center gap-2",children:n?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:r==null?void 0:r.avatar_url,alt:"Avatar",className:"w-5 h-5 rounded-full border border-gray-600"}),t.jsx("span",{className:"text-xs font-medium",children:r==null?void 0:r.name}),t.jsx("button",{onClick:l,className:"p-1 hover:bg-gray-700 rounded transition-colors",title:"Sign out",children:t.jsx(it,{className:"w-3 h-3"})})]}):t.jsxs("button",{onClick:c,className:"flex items-center gap-1 px-2 py-1 bg-gray-800 hover:bg-gray-700 rounded text-xs transition-colors",children:[t.jsx(lt,{className:"w-3 h-3"}),"Sign in with GitHub"]})})]}),Ht=({currentPath:n,breadcrumbs:r,navigateUp:c,navigateToPathLevel:l,showNewItemDialog:m,fileInputRef:d,isAuthenticated:f,handleGithubAuth:u})=>t.jsxs("div",{className:"h-12 bg-gray-50 border-b border-gray-200 flex items-center px-4 gap-2",children:[t.jsx("button",{onClick:c,disabled:n.length<=1,className:"p-2 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Go up",children:t.jsx(ie,{className:"w-4 h-4 rotate-180"})}),t.jsx("button",{className:"p-2 hover:bg-gray-200 rounded transition-colors",title:"Refresh",children:t.jsx(rt,{className:"w-4 h-4"})}),t.jsx("div",{className:"flex-1 mx-4",children:t.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded px-3 py-1.5",children:[t.jsx(Ce,{className:"w-4 h-4 text-gray-400 mr-2"}),t.jsx("button",{onClick:()=>l(0),className:"text-sm hover:text-blue-600 transition-colors",children:"This PC"}),r.map((x,N)=>t.jsxs("span",{className:"flex items-center",children:[t.jsx(ie,{className:"w-3 h-3 text-gray-400 mx-1"}),t.jsx("button",{onClick:()=>l(N+1),className:"text-sm text-gray-600 hover:text-blue-600 transition-colors",children:x.name})]},x.id))]})}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("button",{onClick:()=>f?m():u(),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm transition-colors disabled:opacity-50",title:f?"Create new item":"Sign in to create items",children:[t.jsx(ut,{className:"w-4 h-4"}),"New"]}),t.jsx("button",{onClick:()=>{var x;return f?(x=d.current)==null?void 0:x.click():u()},className:"p-2 hover:bg-gray-200 rounded transition-colors",title:f?"Upload files":"Sign in to upload files",children:t.jsx(ft,{className:"w-4 h-4"})})]})]}),Ut=()=>{var ge,be;const[n,r]=o.useState(["root"]),[c,l]=o.useState(new Set),[m,d]=o.useState(new Set(["root"])),[f,u]=o.useState(!1),[x,N]=o.useState(null),[C,i]=o.useState(null),[p,S]=o.useState(!1),[T,a]=o.useState(null),[h,w]=o.useState(""),[R,k]=o.useState(null),[E,M]=o.useState(null),[B,H]=o.useState(null),[ee,q]=o.useState(!1),[te,$]=o.useState(!1),[W,U]=o.useState(!1),L=o.useRef(null),D=o.useRef(null),P=Z(e=>e.fs),v=Z(e=>e.init),y=Z(e=>e.addItems),A=Z(e=>e.renameItem),F=Z(e=>e.deleteItem),V=Z(e=>e.moveItem),O=o.useMemo(()=>{var e;return(e=P.children)==null?void 0:e.find(s=>s.name===".vfsignore"&&s.type==="file")},[P]),_=o.useMemo(()=>!O||!O.content?[]:O.content.split(/\r?\n/).map(e=>e.trim()).filter(e=>e&&!e.startsWith("#")),[O]),ue=o.useMemo(()=>_.map(e=>{const s=e.endsWith("/");let b=(s?e.slice(0,-1):e).replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,".");return s&&(b=`${b}(/.*)?`),new RegExp(`^${b}$`)}),[_]),de=o.useMemo(()=>{var g;let e=P;for(let b=1;b<n.length&&(e=(g=e.children)==null?void 0:g.find(j=>j.id===n[b]),!!e);b++);return((e==null?void 0:e.children)||[]).filter(b=>!(b.name===".vfsignore"||!le.showHiddenFiles&&b.name.startsWith(".")||ue.some(j=>j.test(b.id))))},[P,n,ue,le.showHiddenFiles]),fe=o.useMemo(()=>[...de].sort((e,s)=>e.type!==s.type?e.type==="folder"?-1:1:e.name.localeCompare(s.name)),[de]);o.useEffect(()=>{v().then(()=>d(new Set(["root"])))},[v]);const{DragSelection:Ee}=Tt({onSelectionChange:Ae,isEnabled:te,shouldStartSelecting:e=>{if(e instanceof HTMLElement){let s=e;for(;s&&s!==D.current;){if(s.hasAttribute("data-item-id"))return!1;s=s.parentElement}return!0}return!1},selectionProps:{style:{border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",position:"absolute",zIndex:1e3}}}),ae=o.useCallback(e=>{var g;let s=P;for(let b=1;b<e.length;b++){const j=(g=s.children)==null?void 0:g.find(K=>K.id===e[b]);if(!j)return null;s=j}return s},[P]),Me=o.useCallback(()=>ae(n),[ae,n]),De=o.useCallback(e=>{const s=[...n,e];r(s),l(new Set),d(g=>new Set([...g,e]))},[n]),Pe=o.useCallback(()=>{n.length>1&&(r(n.slice(0,-1)),l(new Set))},[n]),Re=o.useCallback(e=>{const s=n.slice(0,e+1);r(s),l(new Set)},[n]),Te=o.useCallback(e=>{d(s=>{const g=new Set(s);return g.has(e)?g.delete(e):g.add(e),g})},[]);function Ae(e){if(!D.current||!e.width||!e.height)return;H(e);const s=D.current.querySelectorAll("[data-item-id]"),g=new Set;s.forEach(b=>{const j=b.getBoundingClientRect(),K=b.getAttribute("data-item-id");if(!K)return;const X=D.current.getBoundingClientRect(),z={left:j.left-X.left,top:j.top-X.top,right:j.right-X.left,bottom:j.bottom-X.top};!(z.right<e.left||z.left>e.left+e.width||z.bottom<e.top||z.top>e.top+e.height)&&g.add(K)}),l(g)}const Fe=e=>{e.preventDefault(),U(!0)},Ie=e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy",U(!0)},$e=e=>{e.preventDefault(),U(!1)},Le=async e=>{var g;e.preventDefault(),U(!1);const s=Array.from(e.dataTransfer.files);if(s.length>0&&!f&&(oe(),Y.success("Auto-authenticated for file upload")),s.length>0)try{const b=[];for(const j of s){const K=((g=j.name.split(".").pop())==null?void 0:g.toLowerCase())??"",X=At.includes(K);let z;X?z=await new Promise((ye,Ke)=>{const Q=new FileReader;Q.onload=()=>ye(Q.result),Q.onerror=()=>Ke(Q.error),Q.readAsText(j)}):z="[Binary file content]",b.push({id:`file_${Date.now()}_${Math.random().toString(36).slice(2,9)}`,name:j.name,type:"file",size:j.size,content:z})}y(n,b),Y.success(`${b.length} file(s) uploaded`)}catch(b){console.error("Error uploading files:",b),Y.error("Failed to upload files")}},he=e=>{if(!h.trim()||!f)return;const s={id:`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:h.trim(),type:e,...e==="folder"?{children:[]}:{size:0}};y(n,[s]),Y.success(`${e==="folder"?"Folder":"File"} created`),w(""),S(!1)},Oe=(e,s)=>{!s.trim()||!f||(A(n,e,s.trim()),Y.success("Item renamed"),a(null),w(""))},ze=e=>{f&&(F(n,e),Y.success("Item deleted"),l(new Set),i(null))},oe=()=>{u(!0),N({login:"developer-user",avatar_url:"https://github.com/github.png",name:"Developer User"})},Be=()=>{u(!1),N(null),l(new Set)},He=e=>{const s=ce(P,e);s&&(r(s),l(new Set))},Ue=e=>{e.key==="Enter"&&p&&h.trim()?he("folder"):e.key==="Escape"&&(S(!1),a(null),i(null))},Ve=()=>{i(null)},_e=(e,s)=>{s.stopPropagation(),f&&(M(e),s.dataTransfer.setData("text/plain",e),s.dataTransfer.effectAllowed="move",c.has(e)||l(new Set([e])))},pe=(e,s)=>{s.preventDefault(),s.stopPropagation(),E&&E!==e&&(k(e),s.dataTransfer.dropEffect="move")},me=()=>{k(null)},xe=(e,s)=>{if(s.preventDefault(),s.stopPropagation(),k(null),!E||!f||E===e)return;const g=ce(P,e);g&&(V(n,E,g),M(null))},Ge=e=>{if(e.target===D.current||e.target===e.currentTarget)$(!0);else{let s=e.target,g=!1;for(;s&&s!==D.current;){if(s.hasAttribute("data-item-id")){g=!0;break}s=s.parentElement}g||$(!0)}q(!0)},qe=()=>{q(!1),$(!1),H(null)},G=Me(),We=n.slice(1).reduce((e,s,g)=>{const b=n.slice(0,g+2),j=ae(b);return j&&e.push({id:s,name:j.name,path:b}),e},[]);return t.jsxs("div",{className:"h-screen flex flex-col bg-white",onClick:Ve,children:[t.jsx(Bt,{isAuthenticated:f,user:x,handleGithubAuth:oe,handleLogout:Be}),t.jsx(Ht,{currentPath:n,breadcrumbs:We,navigateUp:Pe,navigateToPathLevel:Re,showNewItemDialog:()=>S(!0),fileInputRef:L,isAuthenticated:f,handleGithubAuth:oe}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsx(zt,{fileSystem:P,expandedFolders:m,selectedItems:c,navigateToQuickAccess:He,toggleFolder:Te,setSelectedItems:l,handleFolderDragOver:pe,handleFolderDragLeave:me,handleFolderDrop:xe,dragOverFolder:R}),t.jsxs("div",{className:`flex-1 p-6 overflow-y-auto bg-white transition-colors duration-200 relative border-2 border-dashed ${W?"border-blue-400 bg-blue-50":"border-transparent"}`,onDragEnter:Fe,onDragOver:Ie,onDragLeave:$e,onDrop:Le,onMouseDown:Ge,onMouseUp:qe,ref:D,children:[t.jsx(Ee,{}),G&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-1",children:G.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[((ge=G.children)==null?void 0:ge.length)||0," item",(((be=G.children)==null?void 0:be.length)||0)!==1?"s":""]})]}),fe.length>0?t.jsx(Ot,{items:fe,selectedItems:c,setSelectedItems:l,navigateToFolder:De,setShowContextMenu:i,handleDragStart:_e,handleFolderDragOver:pe,handleFolderDragLeave:me,handleFolderDrop:xe,dragOverFolder:R,selectionBox:B}):t.jsxs("div",{className:"text-center text-gray-500 mb-8",children:[t.jsx(se,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"This folder is empty"})]})]})]})]}),t.jsx("input",{type:"file",ref:L,multiple:!0,className:"hidden",onChange:e=>{const s=Array.from(e.target.files||[]);console.log("Files selected for upload:",s)}}),C&&t.jsx(It,{position:{x:C.x,y:C.y},itemId:C.itemId,onRename:e=>{var g;const s=(g=G==null?void 0:G.children)==null?void 0:g.find(b=>b.id===e);s&&(w(s.name),a(e))},onDelete:ze,setShowContextMenu:i}),p&&t.jsx($t,{newItemName:h,setNewItemName:w,setShowNewItemDialog:S,createNewItem:he,handleKeyDown:Ue}),T&&t.jsx(Lt,{newItemName:h,setNewItemName:w,setShowRenameDialog:a,renameItem:Oe,showRenameDialog:T})]})},Yt={id:ve.id,manifest:ve,init:async()=>{},render:()=>t.jsx(Ut,{}),onOpen:()=>{},onClose:()=>{}};export{Yt as default};
