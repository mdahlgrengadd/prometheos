import{r as c,j as e}from"./index-4Gnpq0JH.js";import{H as F,J as o,t as A,K as b}from"./MacroContext-CEG8-rAs.js";import"./monaco-editor-Dq6WuQlL.js";const O=()=>{const{registerComponent:j,unregisterComponent:N}=F(),[i,n]=c.useState("0"),[g,p]=c.useState(null),[f,k]=c.useState(null),[w,u]=c.useState(!1),[R,x]=c.useState(!1),[r,y]=c.useState(!1);c.useEffect(()=>{(async()=>{try{if(await b.isPluginRegistered("calculator"))y(!0),console.log("Calculator worker already registered");else{let d;o.workerEntrypoint?d=`/worker/${o.workerEntrypoint}`:console.error("No workerEntrypoint defined in manifest"),d&&(await b.registerPlugin(o.id,d)?(y(!0),console.log("Calculator worker registered successfully")):console.error("Failed to register calculator worker"))}}catch(t){console.error("Error initializing calculator worker:",t)}})();const l={id:o.id,type:"Calculator",name:o.name,description:o.description,path:`/api/${o.id}`,state:{enabled:!0,visible:!0},actions:[{id:"add",name:"Add",description:"Add two numbers",parameters:[{name:"a",type:"number",description:"First operand",required:!0},{name:"b",type:"number",description:"Second operand",required:!0}],available:!0}]};return j(l),A(o.id,"add",async t=>{const d=t==null?void 0:t.a,C=t==null?void 0:t.b;if(typeof d!="number"||typeof C!="number")return{success:!1,error:"Invalid parameters for add"};try{return{success:!0,data:await b.calculate(d,C,"+")}}catch(h){return{success:!1,error:h instanceof Error?h.message:String(h)}}}),()=>{N(o.id)}},[]);const s=a=>{w?(n(a),u(!1)):n(i==="0"?a:i+a)},E=()=>{if(w){n("0."),u(!1);return}i.includes(".")||n(i+".")},S=()=>{n("0"),p(null),k(null),u(!1)},m=async a=>{const l=parseFloat(i);if(g===null)p(l);else if(f){x(!0);try{const t=await b.calculate(g,l,f);n(String(t)),p(t)}catch(t){console.error("Calculator worker error:",t),n("Error")}finally{x(!1)}}u(!0),k(a)},v=async()=>{if(g===null||f===null)return;const a=parseFloat(i);x(!0);try{const l=await b.calculate(g,a,f);n(String(l)),p(l),k(null),u(!0)}catch(l){console.error("Calculator worker error:",l),n("Error")}finally{x(!1)}};return e.jsxs("div",{className:"flex flex-col p-4 calculator-root h-full",children:[e.jsx("div",{className:"flex-row bg-card p-2 mb-2 text-right text-xl h-10 overflow-hidden text-foreground border border-border",children:i}),e.jsxs("div",{className:"flex-row grid grid-cols-4 gap-1 grow",children:[e.jsx("button",{onClick:S,className:"col-span-2 bg-red-500 text-white p-2",disabled:!r,children:"AC"}),e.jsx("button",{onClick:()=>m("/"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"/"}),e.jsx("button",{onClick:()=>m("*"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"Ã—"}),e.jsx("button",{onClick:()=>s("7"),className:"bg-card p-2 text-foreground",disabled:!r,children:"7"}),e.jsx("button",{onClick:()=>s("8"),className:"bg-card p-2 text-foreground",disabled:!r,children:"8"}),e.jsx("button",{onClick:()=>s("9"),className:"bg-card p-2 text-foreground",disabled:!r,children:"9"}),e.jsx("button",{onClick:()=>m("-"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"-"}),e.jsx("button",{onClick:()=>s("4"),className:"bg-card p-2 text-foreground",disabled:!r,children:"4"}),e.jsx("button",{onClick:()=>s("5"),className:"bg-card p-2 text-foreground",disabled:!r,children:"5"}),e.jsx("button",{onClick:()=>s("6"),className:"bg-card p-2 text-foreground",disabled:!r,children:"6"}),e.jsx("button",{onClick:()=>m("+"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"+"}),e.jsx("button",{onClick:()=>s("1"),className:"bg-card p-2 text-foreground",disabled:!r,children:"1"}),e.jsx("button",{onClick:()=>s("2"),className:"bg-card p-2 text-foreground",disabled:!r,children:"2"}),e.jsx("button",{onClick:()=>s("3"),className:"bg-card p-2 text-foreground",disabled:!r,children:"3"}),e.jsx("button",{onClick:v,className:"bg-blue-500 text-white p-2 row-span-2",disabled:!r,children:"="}),e.jsx("button",{onClick:()=>s("0"),className:"bg-card p-2 col-span-2 text-foreground",disabled:!r,children:"0"}),e.jsx("button",{onClick:E,className:"bg-card p-2 text-foreground",disabled:!r,children:"."})]})]})},I={id:o.id,manifest:o,init:async()=>{console.log("Calculator plugin initialized")},render:()=>e.jsx(O,{})};export{I as default};
