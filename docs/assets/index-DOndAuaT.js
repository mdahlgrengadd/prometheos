var Ce=Object.defineProperty;var Me=(o,t,a)=>t in o?Ce(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a;var te=(o,t,a)=>Me(o,typeof t!="symbol"?t+"":t,a);import{c as b,r as c,j as e,f as q,a2 as Oe,a3 as Ee,a4 as me,a5 as $e,a6 as Ae,a7 as ue,a8 as pe,a9 as ge,t as F}from"./index-B1NPGn4R.js";import{B as S,a0 as He,I as Z,a1 as he}from"./MacroContext-CVlmrN9y.js";import{L as _}from"./label-BtYUOwfp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=b("FileCode",[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=b("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=b("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=b("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=b("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=b("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=b("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=b("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=b("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=b("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=b("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=b("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=b("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=b("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),V=class V{constructor(){te(this,"FILES_KEY","filebrowser_files");te(this,"DRIVES_KEY","filebrowser_drives");if(this.getDrives().length===0){const t={id:"local-drive",name:"Local Drive",type:"local",readOnly:!1,createdAt:Date.now()};this.saveDrive(t),this.saveFile({id:"root",name:"Root",type:"folder",parent:null,path:"/",driveId:"local-drive",modifiedAt:Date.now(),createdAt:Date.now()})}}static getInstance(){return V.instance||(V.instance=new V),V.instance}getFiles(){const t=localStorage.getItem(this.FILES_KEY);return t?JSON.parse(t):[]}getFileById(t){return this.getFiles().find(a=>a.id===t)||null}getFilesByParent(t,a){return this.getFiles().filter(l=>l.parent===t&&l.driveId===a)}saveFile(t){const a=this.getFiles(),l=a.findIndex(n=>n.id===t.id);l>=0?a[l]={...a[l],...t,modifiedAt:Date.now()}:a.push(t),localStorage.setItem(this.FILES_KEY,JSON.stringify(a))}deleteFile(t){const a=[t],l=this.getFiles(),n=h=>{l.filter(y=>y.parent===h).forEach(y=>{a.push(y.id),y.type==="folder"&&n(y.id)})};n(t);const d=l.filter(h=>!a.includes(h.id));localStorage.setItem(this.FILES_KEY,JSON.stringify(d))}moveFile(t,a,l){const n=this.getFiles(),d=n.findIndex(h=>h.id===t);if(d>=0){const h=n[d];if(n[d]={...h,parent:a,path:l,modifiedAt:Date.now()},h.type==="folder"){h.path;const N=(y,O)=>{n.filter(v=>v.parent===y).forEach(v=>{const E=n.findIndex(u=>u.id===v.id),A=`${O}/${v.name}`;n[E]={...v,path:A,modifiedAt:Date.now()},v.type==="folder"&&N(v.id,A)})};N(t,l)}localStorage.setItem(this.FILES_KEY,JSON.stringify(n))}}getDrives(){const t=localStorage.getItem(this.DRIVES_KEY);return t?JSON.parse(t):[]}getDriveById(t){return this.getDrives().find(a=>a.id===t)||null}saveDrive(t){const a=this.getDrives(),l=a.findIndex(n=>n.id===t.id);l>=0?a[l]=t:a.push(t),localStorage.setItem(this.DRIVES_KEY,JSON.stringify(a))}deleteDrive(t){const l=this.getDrives().filter(h=>h.id!==t);localStorage.setItem(this.DRIVES_KEY,JSON.stringify(l));const d=this.getFiles().filter(h=>h.driveId!==t);localStorage.setItem(this.FILES_KEY,JSON.stringify(d))}async connectToGitHub(t,a,l){const n=a.replace(/\/$/,"").split("/"),d=n[n.length-1],h=n[n.length-2],N={id:`github-${h}-${d}`,name:`${h}/${d}`,type:"github",url:a,token:t,readOnly:l,createdAt:Date.now()};return this.saveDrive(N),this.saveFile({id:`${N.id}-root`,name:d,type:"folder",parent:null,path:"/",driveId:N.id,modifiedAt:Date.now(),createdAt:Date.now()}),N}async addNetworkDrive(t){const a=t.replace(/\/$/,"").split("/"),l=a[a.length-1],n=a[a.length-2],d={id:`network-${Date.now()}`,name:`${n}/${l}`,type:"network",url:t,readOnly:!0,createdAt:Date.now()};return this.saveDrive(d),this.saveFile({id:`${d.id}-root`,name:d.name,type:"folder",parent:null,path:"/",driveId:d.id,modifiedAt:Date.now(),createdAt:Date.now()}),d}};te(V,"instance");let le=V;const x=le.getInstance();function Ye(){const[o,t]=c.useState([]),[a,l]=c.useState([]),[n,d]=c.useState(null),[h,N]=c.useState("local-drive"),[y,O]=c.useState([]);c.useEffect(()=>{if(I(),v(),!n){const i=x.getFilesByParent(null,"local-drive")[0];i&&d(i.id)}},[n]);const I=()=>{const i=x.getFiles();t(i)},v=()=>{const i=x.getDrives();l(i)},E=()=>x.getFilesByParent(n,h),A=()=>n?x.getFileById(n):null,u=i=>{d(i),O([])},M=()=>{const i=x.getFileById(n||"");i&&i.parent!==null&&u(i.parent)};return{files:o,drives:a,currentDirectory:n,currentDrive:h,selectedItems:y,setSelectedItems:O,getCurrentDirectoryFiles:E,getCurrentDirectoryInfo:A,navigateToDirectory:u,navigateToParentDirectory:M,navigateToDrive:i=>{N(i);const m=x.getFilesByParent(null,i)[0];m&&d(m.id),O([])},createFile:(i,m="")=>{const p=`file-${Date.now()}`,f=x.getFileById(n||""),D=f?f.path.replace(/\/$/,""):"",C=f?`${D}/${i}`:`/${i}`,Y={id:p,name:i,type:"file",parent:n,content:m,path:C,driveId:h,modifiedAt:Date.now(),createdAt:Date.now()};return x.saveFile(Y),I(),Y},createFolder:i=>{const m=`folder-${Date.now()}`,p=x.getFileById(n||""),f=p?p.path.replace(/\/$/,""):"",D=p?`${f}/${i}`:`/${i}`,C={id:m,name:i,type:"folder",parent:n,path:D,driveId:h,modifiedAt:Date.now(),createdAt:Date.now()};return x.saveFile(C),I(),C},deleteItem:i=>{x.deleteFile(i),i===n&&M(),I()},moveItem:(i,m)=>{const p=x.getFileById(i),f=x.getFileById(m);if(p&&f&&f.type==="folder"){const D=`${f.path}/${p.name}`;x.moveFile(i,m,D),I()}},updateItem:(i,m)=>{const p=x.getFileById(i);p&&(x.saveFile({...p,...m}),I())},addNetworkDrive:async i=>{const m=await x.addNetworkDrive(i);return v(),m},connectToGitHub:async(i,m,p)=>{const f=await x.connectToGitHub(i,m,p);return v(),f}}}const Je=({selectedDrive:o,onDriveSelect:t,drives:a})=>{const l=n=>{switch(n){case"github":return e.jsx(xe,{className:"h-4 w-4 mr-2"});case"network":return e.jsx(fe,{className:"h-4 w-4 mr-2"});default:return e.jsx(Ve,{className:"h-4 w-4 mr-2"})}};return e.jsxs("div",{className:"w-48 border-r p-2 h-full bg-muted/20",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2 px-2",children:"Drives"}),e.jsx("div",{className:"space-y-1",children:a.map(n=>e.jsxs("div",{className:q("flex items-center px-2 py-1.5 text-sm rounded-md cursor-pointer hover:bg-muted",o===n.id&&"bg-muted"),onClick:()=>t(n.id),children:[l(n.type),e.jsx("span",{className:"truncate",children:n.name}),n.readOnly&&e.jsx("span",{className:"ml-auto text-xs text-muted-foreground",children:"(RO)"})]},n.id))}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2 px-2",children:"Quick Access"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center px-2 py-1.5 text-sm rounded-md cursor-pointer hover:bg-muted",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Documents"})]}),e.jsxs("div",{className:"flex items-center px-2 py-1.5 text-sm rounded-md cursor-pointer hover:bg-muted",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Pictures"})]})]})]})]})},se=Oe,Ze=Ee,ye=c.forwardRef(({className:o,...t},a)=>e.jsx(pe,{ref:a,className:q("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",o),...t}));ye.displayName=pe.displayName;const Q=c.forwardRef(({className:o,children:t,...a},l)=>e.jsxs(Ze,{children:[e.jsx(ye,{}),e.jsxs(me,{ref:l,className:q("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-[var(--background)] p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),...a,children:[t,e.jsxs($e,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Q.displayName=me.displayName;const X=({className:o,...t})=>e.jsx("div",{className:q("flex flex-col space-y-1.5 text-center sm:text-left",o),...t});X.displayName="DialogHeader";const W=({className:o,...t})=>e.jsx("div",{className:q("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",o),...t});W.displayName="DialogFooter";const ee=c.forwardRef(({className:o,...t},a)=>e.jsx(ue,{ref:a,className:q("text-lg font-semibold leading-none tracking-tight",o),...t}));ee.displayName=ue.displayName;const _e=c.forwardRef(({className:o,...t},a)=>e.jsx(ge,{ref:a,className:q("text-sm text-muted-foreground",o),...t}));_e.displayName=ge.displayName;const Qe=({selectedItems:o,refreshFiles:t,navigateToParentDirectory:a,currentDir:l,createFile:n,createFolder:d,deleteItem:h,addNetworkDrive:N,connectToGitHub:y})=>{const[O,I]=c.useState(!1),[v,E]=c.useState(!1),[A,u]=c.useState(!1),[M,K]=c.useState(!1),[j,L]=c.useState(""),[H,z]=c.useState(""),[U,R]=c.useState(""),[P,i]=c.useState(""),[m,p]=c.useState(!1),f=()=>{j.trim()&&(n(j.trim()),L(""),I(!1),t(),F({title:"File Created",description:`${j.trim()} has been created successfully.`}))},D=()=>{j.trim()&&(d(j.trim()),L(""),E(!1),t(),F({title:"Folder Created",description:`${j.trim()} has been created successfully.`}))},C=()=>{o.length>0&&(o.forEach(w=>{h(w)}),t(),F({title:"Deleted",description:`${o.length} item(s) have been deleted.`}))},Y=async()=>{if(H.trim())try{await N(H.trim()),z(""),u(!1),t(),F({title:"Network Drive Added",description:"Network drive has been added successfully."})}catch{F({title:"Error",description:"Failed to add network drive.",variant:"destructive"})}},ae=async()=>{if(U.trim()&&P.trim())try{await y(U.trim(),P.trim(),!1),R(""),i(""),K(!1),p(!0),t(),F({title:"GitHub Connected",description:"GitHub repository has been connected successfully."})}catch{F({title:"Error",description:"Failed to connect to GitHub.",variant:"destructive"})}},ne=()=>{p(!1),F({title:"Logged Out",description:"You have been logged out from GitHub."})};return e.jsxs("div",{className:"flex items-center space-x-2 p-2 border-b bg-muted/40",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:a,disabled:!(l!=null&&l.parent),children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),"Up"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>I(!0),children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"New File"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>E(!0),children:[e.jsx(Ge,{className:"h-4 w-4 mr-1"}),"New Folder"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:C,disabled:o.length===0,children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),"Delete"]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:t,children:[e.jsx(Ke,{className:"h-4 w-4 mr-1"}),"Refresh"]}),e.jsxs("div",{className:"ml-auto flex items-center space-x-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>u(!0),children:[e.jsx(fe,{className:"h-4 w-4 mr-1"}),"Add Network"]}),m?e.jsxs(S,{variant:"outline",size:"sm",onClick:ne,children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),"Logout"]}):e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>K(!0),children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"GitHub Login"]})]}),e.jsx(se,{open:O,onOpenChange:I,children:e.jsxs(Q,{children:[e.jsx(X,{children:e.jsx(ee,{children:"Create New File"})}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"name",className:"text-right",children:"Name"}),e.jsx(Z,{id:"name",value:j,onChange:w=>L(w.target.value),className:"col-span-3"})]})}),e.jsx(W,{children:e.jsx(S,{type:"submit",onClick:f,children:"Create"})})]})}),e.jsx(se,{open:v,onOpenChange:E,children:e.jsxs(Q,{children:[e.jsx(X,{children:e.jsx(ee,{children:"Create New Folder"})}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"name",className:"text-right",children:"Name"}),e.jsx(Z,{id:"name",value:j,onChange:w=>L(w.target.value),className:"col-span-3"})]})}),e.jsx(W,{children:e.jsx(S,{type:"submit",onClick:D,children:"Create"})})]})}),e.jsx(se,{open:A,onOpenChange:u,children:e.jsxs(Q,{children:[e.jsx(X,{children:e.jsx(ee,{children:"Add Network Drive"})}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"url",className:"text-right",children:"GitHub URL"}),e.jsx(Z,{id:"url",value:H,onChange:w=>z(w.target.value),className:"col-span-3",placeholder:"https://github.com/username/repo"})]})}),e.jsx(W,{children:e.jsx(S,{type:"submit",onClick:Y,children:"Add Drive"})})]})}),e.jsx(se,{open:M,onOpenChange:K,children:e.jsxs(Q,{children:[e.jsx(X,{children:e.jsx(ee,{children:"GitHub Login"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"token",className:"text-right",children:"Access Token"}),e.jsx(Z,{id:"token",type:"password",value:U,onChange:w=>R(w.target.value),className:"col-span-3",placeholder:"GitHub personal access token"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"repo",className:"text-right",children:"Repository"}),e.jsx(Z,{id:"repo",value:P,onChange:w=>i(w.target.value),className:"col-span-3",placeholder:"https://github.com/username/repo"})]})]}),e.jsx(W,{children:e.jsx(S,{type:"submit",onClick:ae,children:"Connect"})})]})})]})},Xe=()=>{const{getCurrentDirectoryFiles:o,getCurrentDirectoryInfo:t,navigateToDirectory:a,navigateToParentDirectory:l,navigateToDrive:n,currentDrive:d,currentDirectory:h,drives:N,createFile:y,createFolder:O,deleteItem:I,addNetworkDrive:v,connectToGitHub:E,moveItem:A,selectedItems:u,setSelectedItems:M,updateItem:K}=Ye(),[j,L]=c.useState([]),[H,z]=c.useState(null),[U,R]=c.useState(null),[P,i]=c.useState(null),[m,p]=c.useState(""),f=c.useRef(null);c.useEffect(()=>{D()},[d,h]);const D=()=>{const s=o();L(s)},C=t(),ae=((C==null?void 0:C.path)||"/").replace(/\/\/+/,"/"),ne=s=>s.type==="folder"?e.jsx(re,{className:"h-5 w-5 text-yellow-500"}):s.name.match(/\.(jpg|jpeg|png|gif|svg)$/i)?e.jsx(Te,{className:"h-5 w-5 text-blue-500"}):s.name.match(/\.(txt|md)$/i)?e.jsx(Re,{className:"h-5 w-5 text-gray-500"}):s.name.match(/\.(html|css|js|ts|jsx|tsx)$/i)?e.jsx(Pe,{className:"h-5 w-5 text-green-500"}):s.name.match(/\.(csv|xls|xlsx)$/i)?e.jsx(ze,{className:"h-5 w-5 text-green-700"}):e.jsx(Be,{className:"h-5 w-5 text-gray-400"}),w=(s,r)=>{if(r.ctrlKey||r.metaKey)u.includes(s.id)?M(u.filter(g=>g!==s.id)):M([...u,s.id]);else if(r.shiftKey&&u.length>0){const g=j.map(T=>T.id),k=g.indexOf(u[u.length-1]),$=g.indexOf(s.id),B=Math.min(k,$),J=Math.max(k,$),G=g.slice(B,J+1);M([...new Set([...u,...G])])}else M([s.id]),s.type==="folder"&&a(s.id)},ve=s=>{s.type==="folder"?a(s.id):F({title:"File Opened",description:`Opening ${s.name}`})},we=(s,r)=>{z(r),s.dataTransfer.setData("text/plain",r)},Ne=(s,r)=>{s.preventDefault(),R(r)},je=(s,r)=>{if(s.preventDefault(),H&&H!==r){const g=j.find(k=>k.id===r);g&&g.type==="folder"&&(A(H,r),D(),F({title:"Item Moved",description:"Item has been moved successfully."}))}z(null),R(null)},De=s=>{s.preventDefault(),s.dataTransfer.items&&ke(s.dataTransfer.items),R(null)},ke=async s=>{const r=[];for(let g=0;g<s.length;g++){const k=s[g];if(k.kind==="file"){const $=k.getAsFile();$&&r.push(Fe($))}}try{await Promise.all(r),D(),F({title:"Files Uploaded",description:`${r.length} file(s) uploaded successfully.`})}catch{F({title:"Upload Error",description:"Some files failed to upload.",variant:"destructive"})}},Fe=s=>new Promise((r,g)=>{const k=new FileReader;k.onload=$=>{var G,T;const{name:B}=s,J=((T=(G=$.target)==null?void 0:G.result)==null?void 0:T.toString())||"";try{y(B,J),r()}catch(ie){g(ie)}},k.onerror=g,k.readAsText(s)}),be=s=>{i(s.id),p(s.name),setTimeout(()=>{f.current&&(f.current.focus(),f.current.select())},10)},oe=()=>{P&&m.trim()&&(K(P,{name:m.trim()}),i(null),D())},Ie=()=>{const s=document.createElement("input");s.type="file",s.multiple=!0,s.onchange=async r=>{const g=r.target;if(g.files){const k=Array.from(g.files),$=k.map(B=>new Promise((J,G)=>{const T=new FileReader;T.onload=ie=>{var de,ce;try{y(B.name,((ce=(de=ie.target)==null?void 0:de.result)==null?void 0:ce.toString())||""),J()}catch(Se){G(Se)}},T.onerror=G,T.readAsText(B)}));try{await Promise.all($),D(),F({title:"Files Uploaded",description:`${k.length} file(s) uploaded successfully.`})}catch{F({title:"Upload Error",description:"Some files failed to upload.",variant:"destructive"})}}},s.click()};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(Qe,{selectedItems:u,refreshFiles:D,navigateToParentDirectory:l,currentDir:C,createFile:y,createFolder:O,deleteItem:I,addNetworkDrive:v,connectToGitHub:E}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx(Je,{selectedDrive:d,onDriveSelect:n,drives:N}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 text-foreground",onDragOver:s=>{s.preventDefault(),s.stopPropagation()},onDrop:De,children:[e.jsx("div",{className:"text-sm mb-2 pb-1 border-b border-border",children:e.jsxs("span",{children:["Current path: ",ae]})}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:j.map(s=>e.jsxs("div",{className:`
                  p-2 border rounded-md flex flex-col items-center justify-center
                  ${U===s.id&&s.type==="folder"?"bg-blue-100":""}
                  ${u.includes(s.id)?"bg-blue-50 border-blue-300":""}
                  hover:bg-muted/50 cursor-pointer transition-colors
                `,onClick:r=>w(s,r),onDoubleClick:()=>ve(s),onDragStart:r=>we(r,s.id),onDragOver:r=>Ne(r,s.id),onDragEnd:()=>z(null),onDrop:r=>je(r,s.id),draggable:!0,children:[ne(s),P===s.id?e.jsx("div",{className:"mt-1 w-full",children:e.jsx("input",{ref:f,type:"text",className:"w-full text-xs border rounded px-1",value:m,onChange:r=>p(r.target.value),onBlur:oe,onKeyDown:r=>{r.key==="Enter"?oe():r.key==="Escape"&&i(null)}})}):e.jsx("div",{className:"mt-1 text-xs text-center w-full truncate",title:s.name,onContextMenu:r=>{r.preventDefault(),u.includes(s.id)||M([s.id]),be(s)},children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"border-t p-2 flex items-center justify-between bg-muted/20 text-xs text-muted-foreground",children:[e.jsxs("div",{children:[j.length," item(s)"]}),e.jsx("div",{children:e.jsx("button",{onClick:Ie,className:"px-2 py-1 text-xs hover:underline",children:"Upload Files"})})]})]})},at={id:he.id,manifest:he,init:async()=>{console.log("File Browser plugin initialized - "+new Date().toISOString())},render:()=>e.jsx(Xe,{})};export{at as default};
