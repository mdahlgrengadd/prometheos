import{j as t,r as i}from"./index-B10m1NXo.js";import{N}from"./MacroContext-Cqy6Ckua.js";import"./monaco-editor-Dq6WuQlL.js";const G=({initData:o})=>{const U=(o==null?void 0:o.initFromUrl)||"https://en.wikipedia.org",m=(e=>!e.startsWith("http://")&&!e.startsWith("https://")?"https://"+e:e)(U),[y,c]=i.useState(m),[d,u]=i.useState(m),[r,f]=i.useState([m]),[s,p]=i.useState(0),[R,n]=i.useState(!0),[g,x]=i.useState(null),h=i.useRef(null),j=async e=>{try{let a=new URL(e).hostname;a.startsWith("www.")&&(a=a.substring(4));const w=`${window.location.origin}/prometheos/shadownet/${a}/index.html`;if((await fetch(w,{method:"HEAD"})).ok){const k=await(await fetch(w,{method:"GET"})).text();if(!k.includes("<title>Draggable PromethOS</title>")&&!k.includes('id="root"'))return w}}catch{}return e};i.useEffect(()=>{(async()=>{const l=await j(m);u(l),c(l),f([l]),n(!1)})()},[m]);const S=e=>{c(e.target.value)},W=e=>{e.key==="Enter"&&v()},v=async()=>{let e=y;if(!e.startsWith("http://")&&!e.startsWith("https://")&&(e="https://"+e,c(e)),d===e){n(!1);return}n(!0),x(null);const l=await j(e),a=r.slice(0,s+1);a.push(l),f(a),p(a.length-1),u(l)},C=()=>{s>0&&(p(s-1),u(r[s-1]),c(r[s-1]),x(null),n(!0))},E=()=>{s<r.length-1&&(p(s+1),u(r[s+1]),c(r[s+1]),x(null),n(!0))},L=()=>{n(!0),x(null),h.current&&(h.current.src=d)},H=()=>{n(!1);try{if(h.current&&h.current.contentWindow){const e=h.current.contentWindow.location.href;if(e!=="about:blank"&&e!==d&&(c(e),u(e),r[s]!==e)){const l=r.slice(0,s+1);l.push(e),f(l),p(l.length-1)}}}catch{console.log("Couldn't access iframe URL due to security restrictions")}},O=[{name:"Example.com",url:"https://example.com"},{name:"Wikipedia",url:"https://en.wikipedia.org"},{name:"HTML5 Rocks",url:"https://www.html5rocks.com"},{name:"GitHub",url:"https://github.com"},{name:"Stack Overflow",url:"https://stackoverflow.com"}];return t.jsxs("div",{className:"p-0 py-1 flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-center mb-1 space-x-2",children:[t.jsxs("div",{className:"flex space-x-1",children:[t.jsx("button",{onClick:C,disabled:s<=0,className:`px-2 py-1 rounded ${s<=0?"bg-muted text-muted-foreground":"bg-blue-500 text-primary hover:bg-blue-600"}`,"aria-label":"Go back",title:"Go back",children:"←"}),t.jsx("button",{onClick:E,disabled:s>=r.length-1,className:`px-2 py-1 rounded ${s>=r.length-1?"bg-muted text-muted-foreground":"bg-blue-500 text-primary hover:bg-blue-600"}`,"aria-label":"Go forward",title:"Go forward",children:"→"}),t.jsx("button",{onClick:L,className:"px-2 py-1 bg-blue-500 text-primary rounded hover:bg-blue-600","aria-label":"Refresh",title:"Refresh page",children:"⟳"})]}),t.jsxs("div",{className:"relative flex-1 flex items-center",children:[t.jsx("input",{type:"text",className:"flex-1 px-2 py-1 border border-border rounded-l bg-background text-foreground pr-20",placeholder:"Enter URL...",value:y,onChange:S,onKeyPress:W,style:{paddingRight:d.includes("/shadownet/")?"80px":void 0}}),d.includes("/shadownet/")&&t.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 bg-yellow-200 text-yellow-900 text-xs font-semibold px-2 py-0.5 rounded border border-yellow-400 shadow z-10",title:"This is a local mockup, not the real site.",style:{pointerEvents:"none"},children:"MOCKUP"})]}),t.jsx("button",{onClick:()=>v(),className:"bg-blue-500 text-primary px-3 py-1 rounded-r hover:bg-blue-600",children:"Go"})]}),t.jsxs("div",{className:"relative flex-1 bg-background",children:[R&&!g&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background bg-opacity-70 z-10",children:t.jsx("div",{className:"text-blue-500 font-semibold",children:"Loading..."})}),g?t.jsxs("div",{className:"absolute inset-0 flex flex-col p-6 overflow-auto",children:[t.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4",children:t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),t.jsx("div",{className:"ml-3",children:t.jsx("p",{className:"text-sm text-yellow-700",children:g})})]})}),t.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Try these sites instead:"}),t.jsx("ul",{className:"space-y-2",children:O.map(e=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>{c(e.url),u(e.url),x(null),n(!0);const l=r.slice(0,s+1);l.push(e.url),f(l),p(l.length-1)},className:"text-blue-600 hover:underline",children:[e.name," - ",e.url]})},e.url))}),t.jsxs("div",{className:"mt-6 bg-card p-4 rounded-md",children:[t.jsx("h4",{className:"font-medium mb-2",children:"What is X-Frame-Options?"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:'X-Frame-Options is a security header that websites use to prevent "clickjacking" attacks by controlling whether their pages can be embedded in iframes on other domains. When set to "SAMEORIGIN" (as in this case), the page can only be displayed in a frame on the same origin as the page itself.'})]})]}):t.jsx("iframe",{ref:h,src:d,className:"w-full h-full",onLoad:H,title:"Browser content",sandbox:"allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts"})]})]})};let b;const K={id:N.id,manifest:N,init:async o=>{b=o},onOpen:o=>{o&&(b=o)},openWithUrl:o=>{b={initFromUrl:o}},render:()=>t.jsx(G,{initData:b})};export{K as default};
