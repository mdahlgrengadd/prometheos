import{c as B,i as Be,r as l,R as ee,J as He,j as e}from"./index-BUj4FzKP.js";import{ideSettings as se}from"./esbuild-settings-Bzyyd_qg.js";import{F as te,S as Ue,a as Ve,l as Ie}from"./virtual-fs-DnlBjnmA.js";import{a8 as Je,a9 as Ge,aa as _e,b as qe,C as ae,ab as pe}from"./MacroContext-5wkeUggB.js";import{H as be}from"./house-DA_MCJnO.js";import{R as We}from"./refresh-cw-xaHIPJfx.js";import"./monaco-editor-Dq6WuQlL.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=B("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=B("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=B("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=B("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=B("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=B("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=B("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=B("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=B("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=B("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var Q={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function at(n,r){return n+r.charAt(0).toUpperCase()+r.substring(1)}var ot=["Webkit","ms","Moz","O"];Object.keys(Q).forEach(function(n){ot.forEach(function(r){Q[at(r,n)]=Q[n]})});var lt={isUnitlessNumber:Q},it=lt,ct=/^ms-/,dt=/([A-Z])/g;function ut(n){return n.replace(dt,"-$1").toLowerCase()}function ft(n){return ut(n).replace(ct,"-ms-")}var ht=ft,pt=it.isUnitlessNumber,mt=ht,gt=Array.isArray,me=Object.keys,xt=/^(normal|none|(\b(url\([^)]*\)|chapter_counter|attr\([^)]*\)|(no-)?(open|close)-quote|inherit)((\b\s*)|$|\s+))+)$/;function ge(n,r){return!pt[n]&&typeof r=="number"?r=""+r+"px":n==="content"&&!xt.test(r)&&(r="'"+r.replace(/'/g,"\\'")+"'"),mt(n)+": "+r+";  "}function bt(n){var r="";if(!n||me(n).length===0)return r;for(var o=me(n),c=0,m=o.length;c<m;c++){var d=o[c],y=n[d];if(gt(y))for(var u=0,h=y.length;u<h;u++)r+=ge(d,y[u]);else r+=ge(d,y)}return r}var yt=bt;const xe=Be(yt);function X(){return X=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c])}return n},X.apply(this,arguments)}const vt=["style"],wt=l.forwardRef((n,r)=>{let{style:o={}}=n,c=function(u,h){if(u==null)return{};var C,E,i={},g=Object.keys(u);for(E=0;E<g.length;E++)h.indexOf(C=g[E])>=0||(i[C]=u[C]);return i}(n,vt);const m=l.useRef(null),d=l.useRef(null),[,y]=l.useState(0);return l.useImperativeHandle(r,()=>({getBoundingClientRect:()=>{var u;return(u=m.current)==null?void 0:u.getBoundingClientRect()},getParentBoundingClientRect:()=>{var u,h;return m==null||(u=m.current)==null||(h=u.parentElement)==null?void 0:h.getBoundingClientRect()},drawSelectionBox:u=>{requestAnimationFrame(()=>{if(d.current){const h=X({border:"1px solid #4C85D8",background:"rgba(155, 193, 239, 0.4)",position:"absolute",pointerEvents:"none"},o,{top:u.top,left:u.left,width:u.width,height:u.height});d.current.style.cssText=xe(h)}})},clearSelectionBox:()=>{requestAnimationFrame(()=>{d.current&&(d.current.style.cssText=xe({top:0,left:0,width:0,height:0}))})}})),l.useEffect(()=>{y(u=>u+1)},[]),ee.createElement("div",{ref:m},m.current?He.createPortal(ee.createElement("div",X({ref:d},c)),m.current):null)});function jt(n){return(r=>r.width*r.height)(n)>10}function St(n){const{onSelectionChange:r,onSelectionEnd:o,onSelectionStart:c,isEnabled:m=!0,selectionProps:d={},eventsElement:y,shouldStartSelecting:u,isValidSelectionStart:h}=n||{},C=l.useRef(null),{cancelCurrentSelection:E}=function({containerRef:i,onSelectionChange:g,onSelectionStart:S,onSelectionEnd:F,isEnabled:a=!0,eventsElement:x,shouldStartSelecting:j,isValidSelectionStart:N=jt}){const k=l.useRef(null),$=l.useRef(null),M=l.useRef(!1),z=l.useRef(g),I=l.useRef(S),Y=l.useRef(F),q=l.useRef(),ne=l.useRef(a);z.current=l.useCallback(w=>{q.current=g?requestAnimationFrame(()=>{g(w)}):void 0},[g]),I.current=S,Y.current=F,ne.current=a;const U=l.useCallback(()=>{var w;k.current=null,$.current=null,M.current=!1,(w=i.current)==null||w.clearSelectionBox(),typeof q.current=="number"&&cancelAnimationFrame(q.current)},[i]),W=l.useCallback((w,v)=>{var T,L,J;return v||(v=(J=i.current)==null?void 0:J.getParentBoundingClientRect()),{x:w.clientX-(typeof((T=v)==null?void 0:T.left)=="number"?v.left:0),y:w.clientY-(typeof((L=v)==null?void 0:L.top)=="number"?v.top:0)}},[i]),K=l.useCallback((w,v)=>{if(k.current&&$.current){if(!v)return;const L=(({startPoint:P,endPoint:G})=>({left:Math.min(P.x,G.x),top:Math.min(P.y,G.y),width:Math.abs(P.x-G.x),height:Math.abs(P.y-G.y)}))({startPoint:k.current,endPoint:$.current}),J=X({},L,{top:L.top+((v==null?void 0:v.top)||0),left:L.left+((v==null?void 0:v.left)||0)});var T;N(L)?(M.current||(I!=null&&I.current&&I.current(w),M.current=!0),(T=i.current)==null||T.drawSelectionBox(L),z.current==null||z.current(J)):M.current&&(z.current==null||z.current(J))}else U()},[U,i]),H=l.useCallback(w=>{var v;if(!k.current)return;const T=(v=i.current)==null?void 0:v.getParentBoundingClientRect();$.current=W(w,T),K(w,T)},[K,W,i]),O=l.useCallback(w=>{var v;w.button===0&&($.current&&(Y.current==null||Y.current(w)),U(),document.body.style.removeProperty("user-select"),document.body.style.removeProperty("-webkit-user-select"),(x||document.body).removeEventListener("mousemove",H),(v=window)==null||v.removeEventListener("mouseup",O))},[x,U,H]),V=l.useCallback(w=>{if(w.button===0&&ne.current){var v;if(typeof j=="function"&&!j(w.target))return;document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",k.current=W(w),(x||document.body).addEventListener("mousemove",H),(v=window)==null||v.addEventListener("mouseup",O)}},[x,W,H,O]);return l.useEffect(()=>((x||document.body).addEventListener("mousedown",V),()=>{(x||document.body).removeEventListener("mousedown",V),(x||document.body).removeEventListener("mousemove",H),window.removeEventListener("mouseup",O)}),[x,V,H,O]),{cancelCurrentSelection:U}}({containerRef:C,onSelectionEnd:o,onSelectionStart:c,onSelectionChange:r,isEnabled:m,eventsElement:y,shouldStartSelecting:u,isValidSelectionStart:h});return{cancelCurrentSelection:E,DragSelection:l.useCallback(()=>ee.createElement(wt,X({ref:C},d)),[])}}const ye=n=>{var o;if(n.type==="folder")return e.jsx(te,{className:"w-4 h-4 text-blue-500"});switch((o=n.name.split(".").pop())==null?void 0:o.toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return e.jsx(_e,{className:"w-4 h-4 text-green-500"});case"txt":case"doc":case"docx":case"pdf":case"rtf":return e.jsx(Ve,{className:"w-4 h-4 text-red-500"});case"mp3":case"wav":case"flac":case"ogg":return e.jsx(Ge,{className:"w-4 h-4 text-purple-500"});case"mp4":case"avi":case"mkv":case"mov":case"wmv":return e.jsx(st,{className:"w-4 h-4 text-orange-500"});case"zip":case"rar":case"7z":case"tar":case"gz":return e.jsx(Ke,{className:"w-4 h-4 text-yellow-500"});case"js":case"ts":case"html":case"css":case"py":case"java":case"cpp":case"c":case"php":return e.jsx(Je,{className:"w-4 h-4 text-cyan-500"});case"exe":case"msi":case"dmg":return e.jsx(Ue,{className:"w-4 h-4 text-indigo-500"});default:return e.jsx(Ye,{className:"w-4 h-4 text-gray-500"})}},Ct=n=>{if(n===0)return"0 Bytes";const r=1024,o=["Bytes","KB","MB","GB","TB"],c=Math.floor(Math.log(n)/Math.log(r));return parseFloat((n/Math.pow(r,c)).toFixed(2))+" "+o[c]},oe=(n,r,o=["root"])=>{if(n.id===r)return o;if(n.children)for(const c of n.children){const m=oe(c,r,[...o,c.id]);if(m)return m}return null},Nt=({position:n,itemId:r,onRename:o,onDelete:c,setShowContextMenu:m})=>e.jsxs("div",{className:"fixed bg-white border border-gray-200 rounded-lg shadow-xl py-2 z-50 min-w-48",style:{left:n.x,top:n.y},children:[e.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-3 transition-colors",onClick:d=>{d.stopPropagation(),o(r),m(null)},children:[e.jsx(et,{className:"w-4 h-4"}),"Rename"]}),e.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-3 text-red-600 hover:bg-red-50 transition-colors",onClick:d=>{d.stopPropagation(),c(r)},children:[e.jsx(nt,{className:"w-4 h-4"}),"Delete"]})]}),ve=({title:n,inputValue:r,onInputChange:o,onCancel:c,onKeyDown:m,children:d})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:n}),e.jsx("input",{type:"text",value:r,onChange:o,onKeyDown:m,placeholder:"Enter name...",className:"w-full px-3 py-2 border border-gray-300 rounded-md mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:c,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),d]})]})}),kt=({newItemName:n,setNewItemName:r,setShowNewItemDialog:o,createNewItem:c,handleKeyDown:m})=>e.jsxs(ve,{title:"Create New Item",inputValue:n,onInputChange:d=>r(d.target.value),onCancel:()=>{o(!1),r("")},onKeyDown:m,children:[e.jsx("button",{onClick:()=>c("folder"),disabled:!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create Folder"}),e.jsx("button",{onClick:()=>c("file"),disabled:!n.trim(),className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Create File"})]}),Et=({newItemName:n,setNewItemName:r,setShowRenameDialog:o,renameItem:c,showRenameDialog:m})=>e.jsx(ve,{title:"Rename Item",inputValue:n,onInputChange:d=>r(d.target.value),onCancel:()=>{o(null),r("")},onKeyDown:d=>{d.key==="Enter"&&n.trim()?c(m,n):d.key==="Escape"&&(o(null),r(""))},children:e.jsx("button",{onClick:()=>c(m,n),disabled:!n.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Rename"})}),Mt=({items:n,selectedItems:r,setSelectedItems:o,navigateToFolder:c,setShowContextMenu:m,handleDragStart:d,handleFolderDragOver:y,handleFolderDragLeave:u,handleFolderDrop:h,dragOverFolder:C,selectionBox:E})=>e.jsx("div",{className:"mb-8",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1rem",alignItems:"start"},children:n.map(i=>e.jsx("div",{"data-item-id":i.id,className:`p-3 border rounded-lg cursor-pointer hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 ${r.has(i.id)?"bg-blue-50 border-blue-300 shadow-sm":"border-gray-200"} ${C===i.id?"bg-blue-100 border-blue-400":""}`,onClick:g=>{if(g.stopPropagation(),g.ctrlKey||g.metaKey){const S=new Set(r);S.has(i.id)?S.delete(i.id):S.add(i.id),o(S)}else if(g.shiftKey&&r.size>0){const S=n.map(j=>j.id),F=Array.from(r).pop(),a=S.indexOf(F||""),x=S.indexOf(i.id);if(a>=0){const j=Math.min(a,x),N=Math.max(a,x),k=S.slice(j,N+1);o(new Set(k))}}else o(new Set([i.id]))},onDoubleClick:g=>{g.stopPropagation(),i.type==="folder"&&c(i.id)},onContextMenu:g=>{g.preventDefault(),g.stopPropagation(),r.has(i.id)||o(new Set([i.id])),m({x:g.clientX,y:g.clientY,itemId:i.id})},draggable:!0,onDragStart:g=>d&&d(i.id,g),onDragOver:g=>i.type==="folder"&&y&&y(i.id,g),onDragLeave:()=>i.type==="folder"&&u&&u(),onDrop:g=>i.type==="folder"&&h&&h(i.id,g),children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 flex items-center justify-center mb-2",children:ee.cloneElement(ye(i),{className:`w-8 h-8 ${r.has(i.id)?"drop-shadow-sm":""}`})}),e.jsx("span",{className:"text-sm truncate w-full font-medium",title:i.name,children:i.name}),i.type==="file"&&i.size!==void 0&&e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:Ct(i.size)})]})},i.id))}),Pt=({fileSystem:n,expandedFolders:r,selectedItems:o,navigateToQuickAccess:c,toggleFolder:m,setSelectedItems:d,handleFolderDragOver:y,handleFolderDragLeave:u,handleFolderDrop:h,dragOverFolder:C})=>{const E=l.useMemo(()=>{var a;return(a=n.children)==null?void 0:a.find(x=>x.name===".vfsignore"&&x.type==="file")},[n]),i=l.useMemo(()=>!E||!E.content?[]:E.content.split(/\r?\n/).map(a=>a.trim()).filter(a=>a&&!a.startsWith("#")),[E]),g=l.useMemo(()=>i.map(a=>{const x=a.endsWith("/");let N=(x?a.slice(0,-1):a).replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,".");return x&&(N=`${N}(/.*)?`),new RegExp(`^${N}$`)}),[i]),S=l.useCallback(a=>a.filter(x=>!(x.name===".vfsignore"||!se.showHiddenFiles&&x.name.startsWith(".")||g.some(j=>j.test(x.id)))).sort((x,j)=>x.type!==j.type?x.type==="folder"?-1:1:x.name.localeCompare(j.name)),[g]),F=(a,x=0)=>{const j=r.has(a.id),N=o.has(a.id),k=a.type==="folder"&&a.children&&a.children.length>0,$=C===a.id;return e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center gap-2 py-1 px-2 hover:bg-gray-100 cursor-pointer transition-colors ${N?"bg-blue-100 text-blue-700":""} ${$?"bg-blue-100 border-blue-400":""}`,style:{paddingLeft:`${x*20+4}px`},onClick:()=>{a.type==="folder"&&(m(a.id),d(new Set([a.id])))},onDoubleClick:()=>{a.type==="folder"&&c(a.id)},onDragOver:M=>a.type==="folder"&&y&&y(a.id,M),onDragLeave:()=>a.type==="folder"&&u&&u(),onDrop:M=>a.type==="folder"&&h&&h(a.id,M),children:[a.type==="folder"&&e.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:k?j?e.jsx(qe,{className:"w-3 h-3 text-gray-500"}):e.jsx(ae,{className:"w-3 h-3 text-gray-500"}):e.jsx("div",{className:"w-3 h-3"})}),ye(a),e.jsx("span",{className:"text-sm truncate flex-1",children:a.name})]}),a.type==="folder"&&j&&a.children&&e.jsx("div",{children:S(a.children).map(M=>F(M,x+1))})]},a.id)};return e.jsxs("div",{className:"w-64 bg-gray-50 border-r border-gray-200 overflow-y-auto",children:[e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:"Quick Access"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>c("desktop"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:a=>y&&y("desktop",a),onDragLeave:()=>u&&u(),onDrop:a=>h&&h("desktop",a),children:[e.jsx(be,{className:"w-4 h-4 text-blue-500"}),"Desktop"]}),e.jsxs("button",{onClick:()=>c("documents"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:a=>y&&y("documents",a),onDragLeave:()=>u&&u(),onDrop:a=>h&&h("documents",a),children:[e.jsx(te,{className:"w-4 h-4 text-blue-500"}),"Documents"]}),e.jsxs("button",{onClick:()=>c("downloads"),className:"w-full flex items-center gap-2 px-2 py-1.5 text-sm hover:bg-gray-200 rounded text-left transition-colors",onDragOver:a=>y&&y("downloads",a),onDragLeave:()=>u&&u(),onDrop:a=>h&&h("downloads",a),children:[e.jsx(Xe,{className:"w-4 h-4 text-blue-500"}),"Downloads"]})]})]}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-600 mb-3",children:"This PC"}),e.jsx("div",{className:"text-sm",children:F(n)})]})]})},Rt=({isAuthenticated:n,user:r,handleGithubAuth:o,handleLogout:c})=>e.jsxs("div",{className:"h-8 bg-gray-900 text-white flex items-center justify-between px-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"File Explorer"})]}),e.jsx("div",{className:"flex items-center gap-2",children:n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:r==null?void 0:r.avatar_url,alt:"Avatar",className:"w-5 h-5 rounded-full border border-gray-600"}),e.jsx("span",{className:"text-xs font-medium",children:r==null?void 0:r.name}),e.jsx("button",{onClick:c,className:"p-1 hover:bg-gray-700 rounded transition-colors",title:"Sign out",children:e.jsx(Qe,{className:"w-3 h-3"})})]}):e.jsxs("button",{onClick:o,className:"flex items-center gap-1 px-2 py-1 bg-gray-800 hover:bg-gray-700 rounded text-xs transition-colors",children:[e.jsx(Ze,{className:"w-3 h-3"}),"Sign in with GitHub"]})})]}),Dt=({currentPath:n,breadcrumbs:r,navigateUp:o,navigateToPathLevel:c,showNewItemDialog:m,fileInputRef:d,isAuthenticated:y,handleGithubAuth:u})=>e.jsxs("div",{className:"h-12 bg-gray-50 border-b border-gray-200 flex items-center px-4 gap-2",children:[e.jsx("button",{onClick:o,disabled:n.length<=1,className:"p-2 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Go up",children:e.jsx(ae,{className:"w-4 h-4 rotate-180"})}),e.jsx("button",{className:"p-2 hover:bg-gray-200 rounded transition-colors",title:"Refresh",children:e.jsx(We,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex-1 mx-4",children:e.jsxs("div",{className:"flex items-center bg-white border border-gray-300 rounded px-3 py-1.5",children:[e.jsx(be,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("button",{onClick:()=>c(0),className:"text-sm hover:text-blue-600 transition-colors",children:"This PC"}),r.map((h,C)=>e.jsxs("span",{className:"flex items-center",children:[e.jsx(ae,{className:"w-3 h-3 text-gray-400 mx-1"}),e.jsx("button",{onClick:()=>c(C+1),className:"text-sm text-gray-600 hover:text-blue-600 transition-colors",children:h.name})]},h.id))]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>y?m():u(),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm transition-colors disabled:opacity-50",title:y?"Create new item":"Sign in to create items",children:[e.jsx(tt,{className:"w-4 h-4"}),"New"]}),e.jsx("button",{onClick:()=>{var h;return y?(h=d.current)==null?void 0:h.click():u()},className:"p-2 hover:bg-gray-200 rounded transition-colors",title:y?"Upload files":"Sign in to upload files",children:e.jsx(rt,{className:"w-4 h-4"})})]})]}),Ot=()=>{var fe,he;const[n,r]=l.useState({id:"root",name:"My Computer",type:"folder",children:[]}),[o,c]=l.useState(["root"]),[m,d]=l.useState(new Set),[y,u]=l.useState(new Set(["root"])),[h,C]=l.useState(!1),[E,i]=l.useState(null),[g,S]=l.useState(null),[F,a]=l.useState(!1),[x,j]=l.useState(null),[N,k]=l.useState(""),[$,M]=l.useState(null),[z,I]=l.useState(null),[Y,q]=l.useState(null),[ne,U]=l.useState(!1),[W,K]=l.useState(!1),H=l.useRef(null),O=l.useRef(null),V=l.useMemo(()=>{var t;return(t=n.children)==null?void 0:t.find(s=>s.name===".vfsignore"&&s.type==="file")},[n]),w=l.useMemo(()=>!V||!V.content?[]:V.content.split(/\r?\n/).map(t=>t.trim()).filter(t=>t&&!t.startsWith("#")),[V]),v=l.useMemo(()=>w.map(t=>{const s=t.endsWith("/");let f=(s?t.slice(0,-1):t).replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,".");return s&&(f=`${f}(/.*)?`),new RegExp(`^${f}$`)}),[w]),T=l.useMemo(()=>{var p;let t=n;for(let f=1;f<o.length&&(t=(p=t.children)==null?void 0:p.find(b=>b.id===o[f]),!!t);f++);return((t==null?void 0:t.children)||[]).filter(f=>!(f.name===".vfsignore"||!se.showHiddenFiles&&f.name.startsWith(".")||v.some(b=>b.test(f.id))))},[n,o,v,se.showHiddenFiles]),L=l.useMemo(()=>[...T].sort((t,s)=>t.type!==s.type?t.type==="folder"?-1:1:t.name.localeCompare(s.name)),[T]);l.useEffect(()=>{(async()=>{const t=await Ie();r({id:"root",name:"My Computer",type:"folder",children:t}),u(new Set(["root"]))})()},[]);const{DragSelection:J}=St({onSelectionChange:Ne,isEnabled:W,shouldStartSelecting:t=>{if(t instanceof HTMLElement){let s=t;for(;s&&s!==O.current;){if(s.hasAttribute("data-item-id"))return!1;s=s.parentElement}return!0}return!1},selectionProps:{style:{border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",position:"absolute",zIndex:1e3}}}),P=l.useCallback(t=>{var p;let s=n;for(let f=1;f<t.length;f++){const b=(p=s.children)==null?void 0:p.find(R=>R.id===t[f]);if(!b)return null;s=b}return s},[n]),G=l.useCallback(()=>P(o),[P,o]),we=l.useCallback(t=>{const s=[...o,t];c(s),d(new Set),u(p=>new Set([...p,t]))},[o]),je=l.useCallback(()=>{o.length>1&&(c(o.slice(0,-1)),d(new Set))},[o]),Se=l.useCallback(t=>{const s=o.slice(0,t+1);c(s),d(new Set)},[o]),Ce=l.useCallback(t=>{u(s=>{const p=new Set(s);return p.has(t)?p.delete(t):p.add(t),p})},[]);function Ne(t){if(!O.current||!t.width||!t.height)return;q(t);const s=O.current.querySelectorAll("[data-item-id]"),p=new Set;s.forEach(f=>{const b=f.getBoundingClientRect(),R=f.getAttribute("data-item-id");if(!R)return;const D=O.current.getBoundingClientRect(),A={left:b.left-D.left,top:b.top-D.top,right:b.right-D.left,bottom:b.bottom-D.top};!(A.right<t.left||A.left>t.left+t.width||A.bottom<t.top||A.top>t.top+t.height)&&p.add(R)}),d(p)}const ke=t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy",t.currentTarget.classList.add("bg-blue-50","border-blue-300")},Ee=t=>{t.currentTarget.classList.remove("bg-blue-50","border-blue-300")},Me=async t=>{t.preventDefault(),t.currentTarget.classList.remove("bg-blue-50","border-blue-300");const p=Array.from(t.dataTransfer.files);if(p.length>0&&h){const f=G();if(f&&f.children){const b=p.map(R=>({id:`file_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:R.name,type:"file",size:R.size}));r(R=>{const D=JSON.parse(JSON.stringify(R)),A=P(o);return A&&A.children&&(A.children=[...A.children,...b]),D})}}},le=t=>{if(!N.trim()||!h)return;const s={id:`${t}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:N.trim(),type:t,...t==="folder"?{children:[]}:{size:0}};r(p=>{const f=JSON.parse(JSON.stringify(p)),b=P(o);return b&&b.children&&b.children.push(s),f}),k(""),a(!1)},Pe=(t,s)=>{!s.trim()||!h||(r(p=>{const f=JSON.parse(JSON.stringify(p)),b=P(o);if(b&&b.children){const R=b.children.find(D=>D.id===t);R&&(R.name=s.trim())}return f}),j(null),k(""))},Re=t=>{h&&(r(s=>{const p=JSON.parse(JSON.stringify(s)),f=P(o);return f&&f.children&&(f.children=f.children.filter(b=>b.id!==t)),p}),d(new Set),S(null))},ie=()=>{C(!0),i({login:"developer-user",avatar_url:"https://github.com/github.png",name:"Developer User"})},De=()=>{C(!1),i(null),d(new Set)},Oe=t=>{const s=oe(n,t);s&&(c(s),d(new Set))},Te=t=>{t.key==="Enter"&&F&&N.trim()?le("folder"):t.key==="Escape"&&(a(!1),j(null),S(null))},Le=()=>{S(null)},Ae=(t,s)=>{s.stopPropagation(),h&&(I(t),s.dataTransfer.setData("text/plain",t),s.dataTransfer.effectAllowed="move",m.has(t)||d(new Set([t])))},ce=(t,s)=>{s.preventDefault(),s.stopPropagation(),z&&z!==t&&(M(t),s.dataTransfer.dropEffect="move")},de=()=>{M(null)},ue=(t,s)=>{if(s.preventDefault(),s.stopPropagation(),M(null),!z||!h||z===t)return;const p=oe(n,t);if(!p)return;const f=Array.from(m);r(b=>{const R=JSON.parse(JSON.stringify(b)),D=P(o);if(!D||!D.children)return b;const A=D.children.filter(re=>f.includes(re.id));D.children=D.children.filter(re=>!f.includes(re.id));const Z=P(p);return!Z||!Z.children?b:(Z.children=[...Z.children,...A],R)}),I(null)},Fe=t=>{if(t.target===O.current||t.target===t.currentTarget)K(!0);else{let s=t.target,p=!1;for(;s&&s!==O.current;){if(s.hasAttribute("data-item-id")){p=!0;break}s=s.parentElement}p||K(!0)}U(!0)},$e=()=>{U(!1),K(!1),q(null)},_=G(),ze=o.slice(1).reduce((t,s,p)=>{const f=o.slice(0,p+2),b=P(f);return b&&t.push({id:s,name:b.name,path:f}),t},[]);return e.jsxs("div",{className:"h-screen flex flex-col bg-white",onClick:Le,children:[e.jsx(Rt,{isAuthenticated:h,user:E,handleGithubAuth:ie,handleLogout:De}),e.jsx(Dt,{currentPath:o,breadcrumbs:ze,navigateUp:je,navigateToPathLevel:Se,showNewItemDialog:()=>a(!0),fileInputRef:H,isAuthenticated:h,handleGithubAuth:ie}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx(Pt,{fileSystem:n,expandedFolders:y,selectedItems:m,navigateToQuickAccess:Oe,toggleFolder:Ce,setSelectedItems:d,handleFolderDragOver:ce,handleFolderDragLeave:de,handleFolderDrop:ue,dragOverFolder:$}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto bg-white transition-colors duration-200 relative",onDragOver:ke,onDragLeave:Ee,onDrop:Me,onMouseDown:Fe,onMouseUp:$e,ref:O,children:[e.jsx(J,{}),_&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-1",children:_.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[((fe=_.children)==null?void 0:fe.length)||0," item",(((he=_.children)==null?void 0:he.length)||0)!==1?"s":""]})]}),L.length>0?e.jsx(Mt,{items:L,selectedItems:m,setSelectedItems:d,navigateToFolder:we,setShowContextMenu:S,handleDragStart:Ae,handleFolderDragOver:ce,handleFolderDragLeave:de,handleFolderDrop:ue,dragOverFolder:$,selectionBox:Y}):e.jsxs("div",{className:"text-center text-gray-500 mb-8",children:[e.jsx(te,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"This folder is empty"})]})]})]})]}),e.jsx("input",{type:"file",ref:H,multiple:!0,className:"hidden",onChange:t=>{const s=Array.from(t.target.files||[]);console.log("Files selected for upload:",s)}}),g&&e.jsx(Nt,{position:{x:g.x,y:g.y},itemId:g.itemId,onRename:t=>{var p;const s=(p=_==null?void 0:_.children)==null?void 0:p.find(f=>f.id===t);s&&(k(s.name),j(t))},onDelete:Re,setShowContextMenu:S}),F&&e.jsx(kt,{newItemName:N,setNewItemName:k,setShowNewItemDialog:a,createNewItem:le,handleKeyDown:Te}),x&&e.jsx(Et,{newItemName:N,setNewItemName:k,setShowRenameDialog:j,renameItem:Pe,showRenameDialog:x})]})},Ht={id:pe.id,manifest:pe,init:async()=>{},render:()=>e.jsx(Ot,{}),onOpen:()=>{},onClose:()=>{}};export{Ht as default};
