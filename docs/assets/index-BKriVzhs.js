import{r as i,j as e}from"./index-DZRKY3VX.js";import{F as p,G as d}from"./MacroContext-BYcp8_QM.js";const y=()=>{const[n,s]=i.useState("0"),[u,g]=i.useState(null),[x,m]=i.useState(null),[h,c]=i.useState(!1),[C,b]=i.useState(!1),[r,k]=i.useState(!1);i.useEffect(()=>((async()=>{try{if(await p.isPluginRegistered("calculator"))k(!0),console.log("Calculator worker already registered");else{let a;d.workerEntrypoint?a=`/worker/${d.workerEntrypoint}`:console.error("No workerEntrypoint defined in manifest"),a&&(await p.registerPlugin(d.id,a)?(k(!0),console.log("Calculator worker registered successfully")):console.error("Failed to register calculator worker"))}}catch(l){console.error("Error initializing calculator worker:",l)}})(),()=>{}),[]);const t=o=>{h?(s(o),c(!1)):s(n==="0"?o:n+o)},w=()=>{if(h){s("0."),c(!1);return}n.includes(".")||s(n+".")},j=()=>{s("0"),g(null),m(null),c(!1)},f=async o=>{const l=parseFloat(n);if(u===null)g(l);else if(x){b(!0);try{const a=await p.calculate(u,l,x);s(String(a)),g(a)}catch(a){console.error("Calculator worker error:",a),s("Error")}finally{b(!1)}}c(!0),m(o)},N=async()=>{if(u===null||x===null)return;const o=parseFloat(n);b(!0);try{const l=await p.calculate(u,o,x);s(String(l)),g(l),m(null),c(!0)}catch(l){console.error("Calculator worker error:",l),s("Error")}finally{b(!1)}};return e.jsxs("div",{className:"flex flex-col p-4 calculator-root h-full",children:[e.jsxs("div",{className:"flex-row justify-between items-center mb-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Worker Calculator"}),C&&e.jsx("div",{className:"text-xs text-blue-500",children:"Computing..."}),!r&&e.jsx("div",{className:"text-xs text-amber-500",children:"Initializing worker..."})]}),e.jsx("div",{className:"flex-row bg-card p-2 mb-2 text-right text-xl h-10 overflow-hidden text-foreground border border-border",children:n}),e.jsxs("div",{className:"flex-row grid grid-cols-4 gap-1 grow",children:[e.jsx("button",{onClick:j,className:"col-span-2 bg-red-500 text-white p-2",disabled:!r,children:"AC"}),e.jsx("button",{onClick:()=>f("/"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"/"}),e.jsx("button",{onClick:()=>f("*"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"Ã—"}),e.jsx("button",{onClick:()=>t("7"),className:"bg-card p-2 text-foreground",disabled:!r,children:"7"}),e.jsx("button",{onClick:()=>t("8"),className:"bg-card p-2 text-foreground",disabled:!r,children:"8"}),e.jsx("button",{onClick:()=>t("9"),className:"bg-card p-2 text-foreground",disabled:!r,children:"9"}),e.jsx("button",{onClick:()=>f("-"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"-"}),e.jsx("button",{onClick:()=>t("4"),className:"bg-card p-2 text-foreground",disabled:!r,children:"4"}),e.jsx("button",{onClick:()=>t("5"),className:"bg-card p-2 text-foreground",disabled:!r,children:"5"}),e.jsx("button",{onClick:()=>t("6"),className:"bg-card p-2 text-foreground",disabled:!r,children:"6"}),e.jsx("button",{onClick:()=>f("+"),className:"bg-muted p-2 text-foreground",disabled:!r,children:"+"}),e.jsx("button",{onClick:()=>t("1"),className:"bg-card p-2 text-foreground",disabled:!r,children:"1"}),e.jsx("button",{onClick:()=>t("2"),className:"bg-card p-2 text-foreground",disabled:!r,children:"2"}),e.jsx("button",{onClick:()=>t("3"),className:"bg-card p-2 text-foreground",disabled:!r,children:"3"}),e.jsx("button",{onClick:N,className:"bg-blue-500 text-white p-2 row-span-2",disabled:!r,children:"="}),e.jsx("button",{onClick:()=>t("0"),className:"bg-card p-2 col-span-2 text-foreground",disabled:!r,children:"0"}),e.jsx("button",{onClick:w,className:"bg-card p-2 text-foreground",disabled:!r,children:"."})]})]})},F={id:d.id,manifest:d,init:async()=>{console.log("Calculator plugin initialized")},render:()=>e.jsx(y,{})};export{F as default};
